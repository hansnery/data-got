Object ElvenHandmaiden

	;// *** ART Parameters ***
	SelectPortrait = UPHandmaiden

	;// This is required for garrisoned objects - please put in all objects.
	ButtonImage = UIHandmaiden

	Draw = W3DScriptedModelDraw ModuleTag_DRAW

		;WadingParticleSys = EntRipples

		StaticModelLODMode = yes

		OkToChangeModelColor = Yes

		DefaultModelConditionState
			Model					= euNmaiden_skn
			Skeleton				= EUArwen_SKL
		End

		ModelConditionState = RIDER2
			Model					= euNmaidenG_skn
			Skeleton				= EUArwen_SKL
		End

		AnimationState			= STUNNED_FLAILING RIDER2
			Flags               = RANDOMSTART
			Animation
				AnimationName   = EUArwen_FLYA
				AnimationMode   = LOOP
				AnimationSpeedFactorRange	= 0.4 0.6
			End
		End

		AnimationState			= STUNNED_FLAILING
			Flags               = RANDOMSTART
			Animation
				AnimationName   = EUArwen_FLYA
				AnimationMode   = LOOP
				AnimationSpeedFactorRange	= 0.4 0.6
			End
		End

		AnimationState				=	DYING SPLATTED RIDER2
			Animation
				AnimationName		=	EUArwen_LNDA
				AnimationMode		=	ONCE
			End
		End


		AnimationState				=	DYING SPLATTED
			Animation
				AnimationName		=	EUArwen_LNDA
				AnimationMode		=	ONCE
			End
		End

		AnimationState				=	DYING RIDER2
			Animation
				AnimationName		=	EUArwen_DTHA
				AnimationMode		=	ONCE
			End
		End
		AnimationState				=	DYING
			Animation
				AnimationName		=	EUArwen_DTHA
				AnimationMode		=	ONCE
			End
		End

		AnimationState			= STUNNED_STANDING_UP RIDER2
			Animation
				AnimationName   = EUArwen_GTPA
				AnimationMode   = ONCE
			End
		End
		AnimationState			= STUNNED_STANDING_UP
			Animation
				AnimationName   = EUArwen_GTPA
				AnimationMode   = ONCE
			End
		End

		AnimationState			= STUNNED RIDER2
			Animation
				AnimationName   = EUArwen_LNDA
				AnimationMode   = ONCE
			End
		End
		AnimationState			= STUNNED
			Animation
				AnimationName   = EUArwen_LNDA
				AnimationMode   = ONCE
			End
		End

		AnimationState						= PARALYZED RIDER2
			Animation
				AnimationName				= EUArwen_IDLA
				AnimationMode				= LOOP
			End
		End
		AnimationState						= PARALYZED
			Animation
				AnimationName				= EUArwen_IDLA
				AnimationMode				= LOOP
			End
		End


		AnimationState				=	MOVING ATTACKING RIDER2
			Flags					=	RANDOMSTART
			Animation
				AnimationName		=	EUArwen_RUNB
				AnimationMode		=	LOOP
			End
		End

		AnimationState				=	MOVING ATTACKING
			Flags					=	RANDOMSTART
			Animation
				AnimationName		=	EUArwen_RUNB
				AnimationMode		=	LOOP
			End
		End


		AnimationState				=	MOVING RIDER2
			Animation
				AnimationName		=	EUArwen_RUNA
				AnimationMode		=	LOOP
			End
		End

		AnimationState				=	MOVING
			Animation
				AnimationName		=	EUArwen_RUNA
				AnimationMode		=	LOOP
			End
		End

		AnimationState				= USER_1 RIDER2
			Animation
				AnimationName		= EUArwen_SPCA
				AnimationMode		= ONCE
				AnimationBlendTime	= 30
			End
		End

		AnimationState				= USER_1
			Animation
				AnimationName		= EUArwen_SPCA
				AnimationMode		= ONCE
				AnimationBlendTime	= 30
			End
		End

		AnimationState				= USER_2 RIDER2
			Animation
				AnimationName		= EUArwen_LVLA
				AnimationMode		= ONCE
				AnimationBlendTime	= 30
			End
		End

		AnimationState				= USER_2
			Animation
				AnimationName		= EUArwen_LVLA
				AnimationMode		= ONCE
				AnimationBlendTime	= 30
			End
		End

		AnimationState				= USER_3 RIDER2
			Animation
				AnimationName		= EUArwen_SPCC
				AnimationMode		= ONCE
				AnimationBlendTime	= 30
			End
		End

		AnimationState				= USER_3
			Animation
				AnimationName		= EUArwen_SPCC
				AnimationMode		= ONCE
				AnimationBlendTime	= 30
			End
		End

		AnimationState				= SPECIAL_WEAPON_ONE RIDER2
			Animation
				AnimationName		= EUArwen_SPCB
				AnimationMode		= ONCE
				AnimationBlendTime	= 30
			End
		End

		AnimationState				= SPECIAL_WEAPON_ONE
			Animation
				AnimationName		= EUArwen_SPCB
				AnimationMode		= ONCE
				AnimationBlendTime	= 30
			End
		End


		AnimationState				=	FIRING_OR_PREATTACK_A RIDER2
			Animation
				AnimationName		=	eumaiden_atka
				AnimationMode		=	ONCE
				UseWeaponTiming		=	Yes
			End
			Animation
				AnimationName		=	eumaiden_atkb
				AnimationMode		=	ONCE
				UseWeaponTiming		=	Yes
			End
			Animation
				AnimationName		=	eumaiden_atkc
				AnimationMode		=	ONCE
				UseWeaponTiming		=	Yes
			End
		End

		AnimationState				=	FIRING_OR_PREATTACK_A
			Animation
				AnimationName		=	EUArwen_ATKA
				AnimationMode		=	ONCE
				UseWeaponTiming		=	Yes
			End
			Animation
				AnimationName		=	EUArwen_ATKB
				AnimationMode		=	ONCE
				UseWeaponTiming		=	Yes
			End
			Animation
				AnimationName		=	EUArwen_ATKC
				AnimationMode		=	ONCE
				UseWeaponTiming		=	Yes
			End
		End

		AnimationState        = ATTACKING RIDER2
			Animation
				AnimationName     = eumaiden_idla
				AnimationMode     = LOOP
			End
		End

		AnimationState        = ATTACKING
			Animation
				AnimationName     = EUArwen_IDLA
				AnimationMode     = LOOP
			End
		End

		AnimationState			= HIT_REACTION RIDER2
			Animation
				AnimationName	= EUArwen_HITA
				AnimationMode	= ONCE
			End
		End

		AnimationState			= HIT_REACTION
			Animation
				AnimationName	= EUArwen_HITA
				AnimationMode	= ONCE
			End
		End

		TransitionState					=	TRANS_Idle_to_Selected
			Animation
				AnimationName			=	EUArwen_ATNA
				AnimationMode			=	ONCE
			End
		End

		TransitionState					=	TRANS_Selected_To_Idle
			Animation
				AnimationName			=	EUArwen_ATNC
				AnimationMode			=	ONCE
			End
		End

		AnimationState				= LEVELED RIDER2
			Animation
				AnimationName		= EUArwen_LVLA
				AnimationMode		= ONCE
			End
		End

		AnimationState				= LEVELED
			Animation
				AnimationName		= EUArwen_LVLA
				AnimationMode		= ONCE
			End
		End

		AnimationState					= EMOTION_TAUNTING RIDER2
			Animation
				AnimationName			= EUArwen_TNTA
				AnimationMode			= ONCE
			End
			Animation
				AnimationName			= EUArwen_SPCB
				AnimationMode			= ONCE
			End
			Flags						= RESTART_ANIM_WHEN_COMPLETE
		End

		AnimationState					= EMOTION_TAUNTING
			Animation
				AnimationName			= EUArwen_TNTA
				AnimationMode			= ONCE
			End
			Animation
				AnimationName			= EUArwen_SPCB
				AnimationMode			= ONCE
			End
			Flags						= RESTART_ANIM_WHEN_COMPLETE
		End

		AnimationState				=	EMOTION_CELEBRATING RIDER2
			Animation
				AnimationName		=	EUArwen_CHRA
				AnimationMode		=	LOOP
			End
		End

		AnimationState				=	EMOTION_CELEBRATING
			Animation
				AnimationName		=	EUArwen_CHRA
				AnimationMode		=	LOOP
			End
		End

		AnimationState					= EMOTION_ALERT EMOTION_MORALE_HIGH RIDER2
			Animation
				AnimationName			=  EUArwen_TNTA
				AnimationMode			= ONCE
			End
			Animation
				AnimationName			=  EUArwen_TNTB
				AnimationMode			= ONCE
			End
			Flags						= RANDOMSTART RESTART_ANIM_WHEN_COMPLETE
		End

		AnimationState					= EMOTION_ALERT EMOTION_MORALE_HIGH
			Animation
				AnimationName			=  EUArwen_TNTA
				AnimationMode			= ONCE
			End
			Animation
				AnimationName			=  EUArwen_TNTB
				AnimationMode			= ONCE
			End
			Flags						= RANDOMSTART RESTART_ANIM_WHEN_COMPLETE
		End


		AnimationState				=	RAISING_FLAG RIDER2
			Animation
				AnimationName		=	EUArwen_CHRA
				AnimationMode		=	LOOP
			End
		End

		AnimationState				=	RAISING_FLAG
			Animation
				AnimationName		=	EUArwen_CHRA
				AnimationMode		=	LOOP
			End
		End

		AnimationState				=	SELECTED RIDER2
			StateName				=	Selected
			SimilarRestart			=   Yes
			Animation
				AnimationName		=	EUArwen_ATNB
				AnimationMode		=	LOOP
			End
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "Idle" then CurDrawableSetTransitionAnimState("TRANS_Idle_to_Selected") end
			EndScript
		End


		AnimationState				=	SELECTED
			StateName				=	Selected
			SimilarRestart			=   Yes
			Animation
				AnimationName		=	EUArwen_ATNB
				AnimationMode		=	LOOP
			End
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "Idle" then CurDrawableSetTransitionAnimState("TRANS_Idle_to_Selected") end
			EndScript
		End

		AnimationState        = EMOTION_ALERT RIDER2
			Animation
				AnimationName     = eumaiden_idla
				AnimationMode     = LOOP
			End
		End

		AnimationState        = EMOTION_ALERT
			Animation
				AnimationName     = EUArwen_IDLA
				AnimationMode     = LOOP
			End
		End

    IdleAnimationState
			Animation
				AnimationName		= EUArwen_IDLB
				AnimationMode		= ONCE
				AnimationPriority   = 20
			End
			Animation
				AnimationName		= EUArwen_IDLC
				AnimationMode		= ONCE
				AnimationPriority   = 1
			End
			Animation
				AnimationName		= EUArwen_IDLD
				AnimationMode		= ONCE
				AnimationPriority   = 1
			End
			Animation
				AnimationName		= EUArwen_IDLE
				AnimationMode		= ONCE
				AnimationPriority   = 1
			End
			StateName				= Idle
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "Selected" then CurDrawableSetTransitionAnimState("TRANS_Selected_To_Idle") end
			EndScript
      Flags				=	RESTART_ANIM_WHEN_COMPLETE
		End

		AnimationState        = RIDER2
			Animation
				AnimationName		= EUArwen_IDLB
				AnimationMode		= ONCE
				AnimationPriority   = 20
			End
			Animation
				AnimationName		= EUArwen_IDLC
				AnimationMode		= ONCE
				AnimationPriority   = 1
			End
			Animation
				AnimationName		= EUArwen_IDLD
				AnimationMode		= ONCE
				AnimationPriority   = 1
			End
			Animation
				AnimationName		= EUArwen_IDLE
				AnimationMode		= ONCE
				AnimationPriority   = 1
			End
			StateName				= Idle
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "Selected" then CurDrawableSetTransitionAnimState("TRANS_Selected_To_Idle") end
			EndScript
      Flags				=	RESTART_ANIM_WHEN_COMPLETE
	End
	End

    #include "..\..\..\includes\StunDrawModuleSmall.inc"

	;// ***DESIGN parameters ***

	Side = Elves
	EditorSorting = UNIT
	ThreatLevel = 1.0
	TransportSlotCount = TRANSPORTSLOTCOUNT_UNIT


	ArmorSet
		Conditions      = None
		Armor           = HandmaidenArmor
		DamageFX        = NormalDamageFX
	End

	WeaponSet
		Conditions = None
		Weapon = PRIMARY    	HandmaidensWeapon
		;Weapon = QUINARY    	NenyaGleamWeapon
		;AutoChooseSources = QUINARY FROM_PLAYER FROM_SCRIPT		; Not AI.
	End

	BuildCost	 	= 450 ;ANGMAR_NECROMANCER_BUILDCOST
	BuildTime		= 30 ;ANGMAR_NECROMANCER_BUILDTIME

	VisionRange 		= ISENGARD_BERSERKER_VISION_RANGE ;550    ;ANGMAR_NECROMANCER_VISION_RANGE
	VisionSide 		= 35%
	VisionRear 		= 25%
	ShroudClearingRange 	= ISENGARD_BERSERKER_SHROUD_RANGE ;700    ;ANGMAR_NECROMANCER_SHROUD_RANGE

	BountyValue		= 113
	DisplayName		= OBJECT:ElvenHandmaiden
	DisplayNameStrategic		= CONTROLBAR:LW_Unit_ElvenHandmaiden
	DescriptionStrategic	= CONTROLBAR:LW_ToolTip_ElvenHandmaiden
	CrushableLevel		= 0  ;What am I?:        0 = for infantry, 1 = for trees, 2 = general vehicles
	CrusherLevel		= 0 ;What can I crush?: 0 = small animals, 1 = infantry, 2 = trees, 3 = vehicles
 	CrushRevengeWeapon	= BasicInfantryCrushRevenge

	CommandSet		= ElvenHandmaidenCommandSet
	CommandPoints		= 50

	;// *** AUDIO Parameters ***;

	VoiceAttack					= HandmaidensVoiceAttack
	VoiceAttackCharge				= HandmaidensVoiceAttack
	VoiceAttackMachine				= HandmaidensVoiceAttack
	VoiceAttackStructure				= HandmaidensVoiceAttackBuilding
	VoiceCreated					= HandmaidensVoiceSalute
	VoiceFullyCreated				= HandmaidensVoiceSalute
	VoiceGuard					= HandmaidensVoiceMove
	VoiceMove					= HandmaidensVoiceMove
	VoiceMoveToCamp					= HandmaidensVoiceMoveCamp
	VoiceMoveWhileAttacking				= HandmaidensVoiceDisengage
	VoicePriority					= 30
	VoiceRetreatToCastle				= HandmaidensVoiceRetreat
	VoiceSelect					= HandmaidensVoiceSelectMS
	VoiceSelectBattle 				= HandmaidensVoiceSelectBattle

	VoiceEnterStateAttack				= HandmaidensVoiceEnterStateAttack
	VoiceEnterStateAttackCharge			= HandmaidensVoiceEnterStateAttack
	VoiceEnterStateAttackMachine			= HandmaidensVoiceEnterStateAttack
	VoiceEnterStateAttackStructure			= HandmaidensVoiceEnterStateAttackBuilding
	VoiceEnterStateMove				= HandmaidensVoiceEnterStateMove
	VoiceEnterStateMoveToCamp			= HandmaidensVoiceEnterStateMoveCamp
	VoiceEnterStateMoveWhileAttacking		= HandmaidensVoiceEnterStateDisengage
	VoiceEnterStateRetreatToCastle			= HandmaidensVoiceEnterStateRetreat

	SoundImpact					= ImpactHorse

	UnitSpecificSounds
		VoiceEnterUnitEvilMenTransportShip	= HandmaidensVoiceGarrison
		VoiceGarrison				= HandmaidensVoiceGarrison
		VoiceInitiateCaptureBuilding		= HandmaidensVoiceMove
	End

	CrowdResponseKey = Elf

	ClientBehavior = ModelConditionAudioLoopClientBehavior ModuleTag_foo
		ModelCondition = Required:EMOTION_CELEBRATING	Excluded:DYING ENGAGED	Sound:EowynTauntCalloutsLoop	;MOVING ATTACKING
		ModelCondition = Required:EMOTION_TAUNTING		Excluded:DYING ENGAGED	Sound:EowynTauntCalloutsLoop	;MOVING ATTACKING
		;pointing in LGAS
		;ModelCondition = Required:EMOTION_POINTING		Excluded:DYING ENGAGED	Sound:EmotionElfCompilationVoxTauntSinglesLoop
		ModelCondition = Required:RAISING_FLAG			Excluded:DYING ENGAGED	Sound:EowynTauntCalloutsLoop
	End

    #include "..\..\..\includes\StandardUnitEvaEvents.inc"
	;EvaEventDieOwner			= GroupSoldiersOfRhunDie	;Eva event to trigger on unit's death. NOTICE THAT this is only for permanent deaths
										;For deaths you can respawn from, use the DeathFX

	Behavior = LargeGroupAudioUpdate ModuleTag_LGAU		; Tie into LargeGroupAudio system
		Key	= Elf_Female Unit Infantry
	End

	ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
	      MaxUpdateRangeCap = 800
		AnimationSound = Sound:BodyFallGenericNoArmor	Animation:EUARWEN_SKL.EUARWEN_LNDA	Frames:5
		AnimationSound = Sound:BodyFallGenericNoArmor	Animation:EUARWEN_SKL.EUARWEN_DTHA	Frames:33
;;,;; ;;; Restored below AnimationSounds
		AnimationSound = Sound:FootstepDirtA			Animation:EUArwen_SKL.EUArwen_RUNA			Frames:7 19 30 41
		AnimationSound = Sound:SwordIntoScabbard1		Animation:EUArwen_SKL.EUArwen_ATKA			Frames:29
		AnimationSound = Sound:SwordShingClean1			Animation:EUArwen_SKL.EUArwen_ATKC			Frames:26
		AnimationSound = Sound:BodyFallGenericNoArmor	Animation:EUArwen_SKL.EUArwen_DTHA			Frames:30
		AnimationSound = Sound:BodyFallSoldier			Animation:EUArwen_SKL.EUArwen_LNDA			Frames:2
	End

	;// *** ENGINEERING Parameters ***


	RadarPriority = UNIT
	KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS CAN_USE_SIEGE_TOWER SCORE INFANTRY HEAVY_MELEE_HITTER ARMY_SUMMARY CAN_ATTACK ;GRAB_AND_DROP
	PathfindDiameter = 25 ; = 40.0

	Behavior = AutoHealBehavior ModuleTag_BerserkerHealing
		StartsActive = No
		TriggeredBy = Upgrade_ObjectLevel2
		HealingAmount = 20
		HealingDelay = 1000
		StartHealingDelay = HERO_HEAL_DELAY
		HealOnlyIfNotInCombat = Yes
	End

	Body = ActiveBody ModuleTag_02
		CheerRadius 	  = EMOTION_CHEER_RADIUS
		MaxHealth         = 2000 ;1500 ;ANGMAR_THRALL_MASTER_HEALTH
		MaxHealthDamaged  = 400 ;ANGMAR_THRALL_MASTER_HEALTH_DAMAGED
		BurningDeathBehavior = Yes
		BurningDeathFX       = FX_InfantryBurningFlame
		DodgePercent      = 80%
	End

	Behavior = StancesBehavior ModuleTag_StancesBehavior
       	StanceTemplate = Hero
   	End

	Behavior = AIUpdateInterface ModuleTag_03
		AutoAcquireEnemiesWhenIdle = Yes
		MoodAttackCheckRate        = 500
		HoldGroundCloseRangeDistance = 40
		AttackPriority				= 	AttackPriority_Infantry
		AILuaEventsList				=	RevelerFunctions
		BurningDeathTime			=	BURNINGDEATH_DURATION_INFANTRY
	End

	LocomotorSet
		Locomotor = HumanLocomotor
		Condition = SET_NORMAL
		Speed     = NORMAL_FOOT_FAST_MEMBER_SPEED
	End

	LocomotorSet
		Locomotor = BurningDeathLocomotorInfantry
		Condition = SET_BURNINGDEATH
		Speed	  = BURNINGDEATH_WANDERSPEED_INFANTRY
	End


	Behavior = EmotionTrackerUpdate	Module_EmotionTracker
		TauntAndPointDistance				= 300
		TauntAndPointUpdateDelay			= 10000
		AddEmotion			=	Doom_Base
		//	AddEmotion			=   BraceForBeingCrushed_Base
		//	AddEmotion			=	FearIdle_Base
		//	AddEmotion			=	FearBusy_Base
		AddEmotion			=	Point_Base
		AddEmotion			=	Taunt_Base
 		AddEmotion			=	CheerIdle_Base
		AddEmotion			=	CheerBusy_Base
		//	AddEmotion			=	HeroCheerIdle_Base
		//	AddEmotion			=	HeroCheerBusy_Base
		AddEmotion			=	Alert_Base
		AddEmotion			=	CheerForAboutToCrush_Base
	End

	Behavior = PhysicsBehavior ModuleTag_04
		GravityMult = 1.0
		ShockStandingTime		= 4000 ;msec
	End

	Behavior = ProductionUpdate ProductionUpdateModuleTag
		GiveNoXP = Yes
	End

	Behavior = SlowDeathBehavior ModuleTag_05
		DeathTypes = ALL
		SinkDelay = 3000
		SinkRate = 0.40     ; in Dist/Sec
		DestructionDelay = 8000
		Sound = INITIAL HandmaidensVoiceDie
		ShadowWhenDead = No
	End

	Behavior = SquishCollide ModuleTag_06
		;nothing
	End

	Behavior = HitReactionBehavior HitReactionBehaviorModuleTag
		HitReactionLifeTimer1 = 3000	; level 1 (light  damage)  hit reaction animations in ms
		HitReactionThreshold1 = 5.0		; level 1 (light  damage) threshold trigger
	End
	
	#include "..\..\..\includes\CaptureBuilding.inc"	

	;-----------------------------------------------------------------------------
	;	Faithful Service
	;-----------------------------------------------------------------------------

	Behavior = AttributeModifierAuraUpdate ModuleTag_KingsguardLeadershipHeroes
		StartsActive	= Yes ;If no, requires upgrade to turn on.
		BonusName		= FaithfulServiceLeadership
		RefreshDelay	= 2000
		Range			= 200
		ObjectFilter	= ANY +ElvenGaladrielLorien +ElvenGaladrielLorien_WOTR ALLIES
	End

	;-----------------------------------------------------------------------------
	;	Golden Wood Glaive
	;-----------------------------------------------------------------------------

	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
		TriggeredBy = Upgrade_IsengardBerserkerThickSkin
	End

	Behavior = ModelConditionUpgrade ModuleTag_Aylmao
		TriggeredBy			= Upgrade_IsengardBerserkerThickSkin
		AddConditionFlags	= RIDER2
		Permanent			= Yes
	End

	;--------------------------------------------------------------------
	;    Gleam of Nenya
	;-------------------------------------------------------------------

	Behavior = UnpauseSpecialPowerUpgrade ModuleTag_FloodEnabler
		SpecialPowerTemplate = SpecialAbilityGleamofNenya
		TriggeredBy = Upgrade_ObjectLevel3
	End

	Behavior = SpecialPowerModule ModuleTag_FloodStarter
		SpecialPowerTemplate		= SpecialAbilityGleamofNenya
		UpdateModuleStartsAttack	= Yes
		StartsPaused				= Yes
;		InitiateSound				= ArwenVoiceFlood
	End

	Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_FloodUpdate
		SpecialPowerTemplate    = SpecialAbilityGleamofNenya
		SkipContinue			= Yes
		UnpackTime              = 400
 		PreparationTime         = 1
 		PersistentPrepTime      = 1000
 		PackTime                = 1500
		AwardXPForTriggering    = 0
		StartAbilityRange		= 180.0
		ApproachRequiresLOS		= Yes
		SpecialWeapon			= GleamofNenyaFlood
		MustFinishAbility		= Yes
		WhichSpecialWeapon		= 1
;		BusyForDuration			= 2500
	End

    Behavior = AutoAbilityBehavior ModuleTag_ArwenFloodAutoAbility ;;,;;
		SpecialAbility			= SpecialAbilityGleamofNenya
		ForbiddenStatus = INSIDE_GARRISON ;;,;; This seems to prevent the ability from being used inside a tower
		MaxScanRange			= 150.0
		Query						= 20 ALL ENEMIES -STRUCTURE -WALL_UPGRADE -WALL_HUB -WALL_SEGMENT -DEFENSIVE_WALL -FS_BASE_DEFENSE
		Query						= 1 ANY +STRUCTURE ENEMIES
	End
	;-----------------------------------------------------------------------------
	;	Long Memory
	;-----------------------------------------------------------------------------
	Behavior = AttributeModifierUpgrade ModuleTag_LongMemoryBonus
		TriggeredBy			= Upgrade_DwarvenMithrilMail
		AttributeModifier	= LongMemoryBonus
	End
	; ;-----------------------------------------------------------------------------
	;-----------------------------------------------------------------------------
	;	Armor of Doriath
	;-----------------------------------------------------------------------------
	Behavior = AttributeModifierUpgrade ModuleTag_ArmorofDoriathBonus
		TriggeredBy			= Upgrade_SindarinHeavyArmor
		AttributeModifier	= ArmorofDoriathBonus
	End
	Behavior = FireWeaponWhenDamagedBehavior ModuleTag_ArmorofDoriathWeapon
		StartsActive				= No
		TriggeredBy					= Upgrade_SindarinHeavyArmor
		Permanent 					= Yes
		ReactionWeaponPristine 		= ArmorofDoriathWeapon
		ReactionWeaponDamaged		= ArmorofDoriathWeapon
		ReactionWeaponReallyDamaged	= ArmorofDoriathWeapon
		DamageTypes					= ALL -PIERCE -FLAME -MAGIC -FROST -STRUCTURAL -UNDEFINED -HERO_RANGED -POISON
		DamageAmount				= 1
	End
	;-----------------------------------------------------------------------------

	;///////////////////
	; AISpecialPowers
	;///////////////////


	Behavior = AISpecialPowerUpdate GondorFighterHordeCaptureBuildingAI
		CommandButtonName = Command_CaptureBuilding
		SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
	End

	Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
		CommandButtonName = Command_SetStanceBattle
		SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
	End

	Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive ;;,;; Changed for 3.0.1
		CommandButtonName = Command_SetStanceAggressive ;;,;; Changed for 3.0.1
		SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
	End

	Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
		CommandButtonName = Command_SetStanceHoldGround
		SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
	End

	Behavior = AISpecialPowerUpdate ElvenHandmaidenGleamOfNenya
		CommandButtonName = Command_SpecialAbilityGleamOfNenya
		SpecialPowerAIType = AI_SPECIAL_POWER_ENEMY_TYPE_KILLER
	End
	
	// *** AUTO RESOLVE DATA ***
	AutoResolveUnitType = AutoResolveUnit_Soldier
	AutoResolveCombatChain = AutoResolve_SoldierCombatChain
	
	AutoResolveBody = Aotr_AutoResolve_SoldierEliteSingleHordeBody

	AutoResolveArmor
		Armor = Aotr_AutoResolve_EliteSoldierArmor
	End

	AutoResolveWeapon
		Weapon = AutoResolve_EliteInfantrySingleWeapon
	End
	
	AutoResolveLeadership = AutoResolve_HandmaidenBonus
	
	WorldMapArmoryUpgradesAllowed = Upgrade_IsengardBerserkerThickSkin

	Geometry			= CYLINDER
	GeometryMajorRadius = 8.0
	GeometryMinorRadius = 8.0
	GeometryHeight		= 19.2
	GeometryIsSmall		= Yes
	Shadow				= SHADOW_DECAL
	ShadowSizeX			= 19
	ShadowSizeY			= 19
	ShadowTexture		= ShadowI
End

Object RadianceEggHorde

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER EMOTION_TERROR EMOTION_LOOK_TO_SKY EMOTION_TAUNTING EMOTION_POINTING SELECTED
        DefaultModelConditionState
            Model = None
        End

        ModelConditionState = HORDE_EMPTY
            Model = None
        End
    End

   CommandPoints        = 0

    KindOf = UNATTACKABLE

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End
	
    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
		 AILuaEventsList             = InfantryFunctions
    End

    Behavior = HordeContain ModuleTag_HordeContain
        ObjectStatusOfContained =
        InitialPayload          = RadianceEgg 1
        Slots                   = 1
        PassengerFilter         = NONE +CREEP
        RankInfo                = RankNumber:1 UnitType:RadianceEgg Position:X:0 Y:0
    End

	Behavior = SlavedUpdate ModuleTag_Slave
    LeashRange = 1
	GuardMaxRange = 1      ;How far away from master I'm allowed when master is idle (doesn't wander)
    GuardWanderRange = 0   ;How far away I'm allowed to wander from master while guarding.
	AttackRange = 1        ;How far away from master I'm allowed when master is attacking a target.
    AttackWanderRange = 0  ;How far I'm allowed to wander from target.
     ScoutRange = 1         ;How far away from master I'm allowed when master is moving.
     ScoutWanderRange = 0   ;How far I'm allowed to wander from scout point.
    DieOnMastersDeath = Yes
    UseSlaverAsControlForEvaObjectSightedEvents = Yes
    MarkUnselectable = Yes
	End

    LocomotorSet
        Locomotor     = InvisiblePingLocomotor
        Condition     = SET_NORMAL
        Speed         = 1000
    End

     Behavior = DeletionUpdate ModuleTag_032 ; Not LifetimeUpdate, since I can't die.  This will DestroyObject me.
        MinLifetime = 9000
        MaxLifetime = 9000
    End
End

Object RadianceEgg

	Draw = W3DScriptedModelDraw ModuleTag_Draw
        DefaultModelConditionState
            Model = None
        End
    End

    CommandPoints = 10

    TransportSlotCount = TRANSPORTSLOTCOUNT_UNIT
    KindOf    = PRELOAD PATH_THROUGH_EACH_OTHER SCORE THROWN_OBJECT CREEP UNATTACKABLE
    ThreatLevel        = 0

    // *** ENGINEERING Parameters ***
    Body = ActiveBody ModuleTag_011
        MaxHealth        = 1000
        InitialHealth    = 1000
    End

	Behavior = AIUpdateInterface ModuleTag_03
    End

    LocomotorSet
        Locomotor     = InvisiblePingLocomotor
        Condition     = SET_NORMAL
        Speed         = 1000
    End

    Behavior = DeletionUpdate ModuleTag_032 ; Not LifetimeUpdate, since I can't die.  This will DestroyObject me.
        MinLifetime = 9000
        MaxLifetime = 9000
    End

	Behavior = AttributeModifierAuraUpdate ModuleTag_GrimResolve
		StartsActive	= Yes ;If no, requires upgrade to turn on.
		BonusName		= RadianceSelfBuffVisual
		RefreshDelay	= 2000
		Range			= 200
		ObjectFilter	= NONE +ElvenAxeElf +ElvenCerinAmrothGuard +ElvenLorienSentry +LorienStalker +LorienSilverTreeSentinelSwordsman +GaladhrimWarrior
	End

End

Object GleamofNenya

 	Draw = W3DScriptedModelDraw ModuleTag_01
    	DefaultModelConditionState
	      	Model = None
    	End
  	End
	EditorSorting   = SYSTEM
	KindOf = NO_COLLIDE IMMOBILE UNATTACKABLE INERT
	ForceLuaRegistration = Yes ; I have no AI, but I want to send a fear message so please register me.

	; *** ENGINEERING Parameters ***
	Body = ImmortalBody ModuleTag_02
		MaxHealth = 1
		InitialHealth = 1
	End

	; SoundAmbient = TornadoLoopMS

	Behavior = DeletionUpdate ModuleTag_03 ; Not LifetimeUpdate, since I can't die.  This will DestroyObject me.
		MinLifetime = 8000
		MaxLifetime = 8000
	End

	Behavior = FloodUpdate ModuleTag_FloodCentral
		AngleOfFlow = 0	; In degrees, with 0 as screen right
		DirectionIsRelative = Yes ; If it is relative, it adds the facing of the flood object.

		FloodMember
			MemberTemplateName = GleamofNenyaTelekinesis
			ControlPointOffsetOne =		X:-25 Y:0 Z:0
			ControlPointOffsetTwo =		X:0 Y:0 Z:0
			ControlPointOffsetThree =	X:70 Y:0 Z:0
			ControlPointOffsetFour =	X:220 Y:0 Z:0  ;X:100 Y:0 Z:0
			MemberSpeed = 45
		End
	End

	Geometry            = BOX
	GeometryMajorRadius = 10.0
	GeometryMinorRadius = 1.0
	GeometryHeight      = 3.0
	GeometryIsSmall     = No
	Shadow              = NONE
End

;---------------------------------------
Object GleamofNenyaTelekinesis

	Draw = W3DScriptedModelDraw ModuleTag_01
	StaticModelLODMode = yes ; Will append M or L to the skin name depending on GameLOD
		DefaultModelConditionState
			Model = none ;euNmaiden_skn ;NONE
			;ParticleSysBone = Bone05 CrushingBlastNGlow FollowBone:Yes
			; ParticleSysBone = Bone05 WaterHorseTrail2 FollowBone:Yes
			; ParticleSysBone = Bone05 WaterHorseTrail3 FollowBone:Yes
		End

		; IdleAnimationState
			; StateName				= STATE_Idle
			; Animation				= IDLE
				; AnimationName		= FloodHorse_SKL.FloodHorse_RUNA
				; AnimationMode		= LOOP
			; End
			; Flags					= RANDOMSTART
		; End

		; AnimationState				= MOVING
			; Animation				= RUNA
				; AnimationName		= FloodHorse_SKL.FloodHorse_RUNA
				; AnimationMode		= LOOP
			; End
			; Flags					= RANDOMSTART
		; End

	End

	EditorSorting   = SYSTEM
	KindOf = NO_COLLIDE IMMOBILE UNATTACKABLE INERT

	; *** ENGINEERING Parameters ***
	Body = HighlanderBody ModuleTag_02
		MaxHealth = 1
		InitialHealth = 1
	End

	Behavior = FireWeaponUpdate ModuleTag_WeaponFiring
		FireWeaponNugget
			WeaponName = GleamofNenyaFloodRadiusWeapon ;FloodHorseRadiusWeapon
			Offset = X:-15 Y:0 Z:0
			FireDelay = 0
			OneShot = No
		End
	End

	Behavior = SlowDeathBehavior ModuleTag_FadeOut
		DeathTypes			= ALL
		DestructionDelay	= 0
	End

	Geometry = CYLINDER
	GeometryMajorRadius = 17.6
	GeometryHeight = 32.0
	GeometryIsSmall = No
End

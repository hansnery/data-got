;------------------------------------------------------------------------------
; aka Berzerker, Berserker, BeserkerIsengard
Object MahudChief
	Scale = 1.15
	; *** ART Parameters ***

	; This is required for garrisoned objects - please put in all objects.
	ButtonImage				= uimahudchief
	SelectPortrait			= UPMahudChief

	DescriptionStrategic = CONTROLBAR:LW_ToolTip_HaradwaithMahudChief

	Draw = W3DScriptedModelDraw ModuleTag_01

	  OkToChangeModelColor = Yes
	  	StaticModelLODMode = Yes

		DefaultModelConditionState
			Model = humachief_skn
		End

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

		AnimationState			= PACKING_TYPE_1
			StateName		= SPELL
			Animation
				AnimationName     = KUKng_SKL.KUKng_SPCA
				AnimationMode     = ONCE
			End
		End

		AnimationState			= PACKING_TYPE_2
			StateName		= SPELL
			Animation
				AnimationName     = KUKng_SKL.KUKng_LVLA
				AnimationMode     = ONCE
			End
			FXEvent	= Frame:30 Name: FX_UglukHeadHuntStart
		End

		IdleAnimationState
			StateName				= Idle
			Animation
				AnimationName       = KUKng_SKL.KUKng_IDLB
				AnimationPriority	= 4
				AnimationBlendTime	= 10
				AnimationMode       = ONCE
			End
			Animation
				AnimationName       = KUKng_SKL.KUKng_IDLC
				AnimationPriority	= 1
				AnimationBlendTime	= 10
				AnimationMode       = ONCE
			End
			Animation
				AnimationName       = KUKng_SKL.KUKng_IDLD
				AnimationPriority = 1
				AnimationBlendTime	= 10
				AnimationMode       = ONCE
			End
			Animation
				AnimationName       = KUKng_SKL.KUKng_IDLE
				AnimationPriority = 1
				AnimationBlendTime	= 10
				AnimationMode       = ONCE
			End
			Flags				=	RESTART_ANIM_WHEN_COMPLETE
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Selected" then CurDrawableSetTransitionAnimState("TRANS_Selected_to_Idle") end
			EndScript
		End

		AnimationState				=	DYING BURNINGDEATH
			Animation
				AnimationName		=	KUKng_SKL.KUKng_DTHA
				AnimationMode		=	ONCE
				AnimationBlendTime	=	10
			End
		End


		AnimationState = DYING
			Animation
				AnimationName       = KUKng_SKL.KUKng_DTHA
				AnimationMode       = ONCE
			End
		End

		AnimationState				=	BURNINGDEATH
			Animation
				AnimationName		=	KUKng_SKL.KUKng_MFDA
				AnimationMode		=	LOOP
				Distance			=	90
			End
		End

		AnimationState = FREEFALL
			Animation
				AnimationName = KUKng_SKL.KUKng_FLYA
				AnimationMode = LOOP
			End
			Flags = RANDOMSTART
		End

		AnimationState = STUNNED_FLAILING
			Animation
				AnimationName = KUKng_SKL.KUKng_FLYA
				AnimationMode = LOOP
				AnimationSpeedFactorRange	= 0.4 0.6
			End
			Flags = RANDOMSTART
		End

		AnimationState				=	DYING SPLATTED
			Animation
				AnimationName		=	KUKng_SKL.KUKng_LNDA
				AnimationMode		=	ONCE
			End
		End

		AnimationState = STUNNED_STANDING_UP
			Animation
				AnimationName = KUKng_SKL.KUKng_GTPA
				AnimationMode = ONCE
			End
		End

		AnimationState			= STUNNED
			Animation
				AnimationName   = KUKng_SKL.KUKng_LNDA
				AnimationMode   = ONCE
			End
		End

;-----------------
		AnimationState = MOVING FIRING_OR_PREATTACK_A GARRISONED
			Animation
				AnimationName = KUKng_SKL.KUKng_CHRA
				AnimationMode = LOOP
			End

			Flags = RESTART_ANIM_WHEN_COMPLETE
		End
;-----------------

		AnimationState = MOVING FIRING_OR_PREATTACK_A
			Animation
				AnimationName = KUKng_SKL.KUKng_RUNB
				AnimationMode = LOOP
			End

			Flags = RESTART_ANIM_WHEN_COMPLETE
		End

		AnimationState = FIRING_OR_PREATTACK_A
			Animation
				AnimationName = KUKng_SKL.KUKng_ATKA
				AnimationMode = ONCE
			End
			Animation
				AnimationName = KUKng_SKL.KUKng_ATKB
				AnimationMode = ONCE
			End
			Animation
				AnimationName = KUKng_SKL.KUKng_ATKC
				AnimationMode = ONCE
			End
			Animation
				AnimationName = KUKng_SKL.KUKng_SPCB
				AnimationMode = ONCE
			End
		End

;------------
		AnimationState = MOVING GARRISONED
			Animation
				AnimationName = KUKng_SKL.KUKng_CHRA
				AnimationMode = LOOP
			End
			Flags = RESTART_ANIM_WHEN_COMPLETE
		End
;-----------
		AnimationState = MOVING
			Animation
				AnimationName = KUKng_SKL.KUKng_RUNB
				AnimationMode = LOOP
			End
			Flags = RESTART_ANIM_WHEN_COMPLETE
		End

		; --------- Click and Hit Reactions ------------
		AnimationState = HIT_REACTION HIT_LEVEL_1
			Animation = Hit_Level_1_a
				AnimationName = KUKng_SKL.KUKng_HITA
				AnimationMode = ONCE
			End
		End

		AnimationState = LEVELED
			Animation = Hit_Level_1_a
				AnimationName = KUKng_SKL.KUKng_LVLA
				AnimationMode = ONCE
			End
		End

		AnimationState = ENGAGED
			Animation
				AnimationName = KUKng_SKL.KUKng_APPA
				AnimationMode = LOOP
			End
		End


		AnimationState = EMOTION_CELEBRATING
			Animation
				AnimationName = KUKng_SKL.KUKng_CHRA
				AnimationMode = LOOP
			End
		End

		AnimationState							= EMOTION_TAUNTING
			Animation							= TNTA
				AnimationName					= KUKng_SKL.KUKng_TNTA
				AnimationMode					= ONCE
				AnimationSpeedFactorRange		= 0.8 1.2
			End
			Flags				=	RESTART_ANIM_WHEN_COMPLETE
		End

		AnimationState = RAISING_FLAG
			Animation
				AnimationName = KUKng_SKL.KUKng_CHRA
				AnimationMode = LOOP
			End
		End

		AnimationState = SELECTED
			Animation
				AnimationName = KUKng_SKL.KUKng_ATNB
				AnimationMode = LOOP
			End
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Idle" then CurDrawableSetTransitionAnimState("TRANS_Idle_to_Selected") end
			EndScript
		End

    	TransitionState = TRANS_Idle_to_Selected
		Animation = ATNA
			AnimationName		= KUKng_SKL.KUKng_ATNA
			AnimationMode		= ONCE
			AnimationBlendTime	= 10
		End
    	End

    	TransitionState = TRANS_Selected_to_Idle
		Animation = ATNF
			AnimationName		= KUKng_SKL.KUKng_ATNC
			AnimationMode		= ONCE
			AnimationBlendTime	= 10
		End
    	End


		; --- Morgul Blade Weapon anim
		AnimationState        = SPECIAL_WEAPON_ONE
			StateName		= Attacking
			Animation             = SPCB
				AnimationName       = KUKng_SKL.KUKng_SPCB
				AnimationMode       = ONCE
			End
		End

		AnimationState			= SPECIAL_POWER_1
			StateName		= SPECIAL_POWER_1
			Animation
				AnimationName     = KUKng_SKL.KUKng_SPCD
				AnimationMode     = ONCE
			End
		End

		AnimationState			= SPECIAL_POWER_2
			StateName		= SPECIAL_POWER_2
			Animation
				AnimationName     = KUKng_SKL.KUKng_SPCA
				AnimationMode     = ONCE
			End
		End

	End

    #include "..\..\..\includes\StunDrawModuleSmall.inc"

	; ***DESIGN parameters ***
	Side			= Angmar
	EditorSorting		= UNIT

	ThreatLevel		= ISENGARD_BESERKER_THREAT_LEVEL
	ThreatBreakdown 	= IsengardBeserker_DetailedThreat
		AIKindOf 	= INFANTRY
	End

	ThingClass		= HORDE_UNIT
	CommandPoints		= 50 ;;,;; 30 ;;,;; 25
	BuildCost		= 550 ;ISENGARD_BERSERKER_BUILDCOST
	BuildTime		= 30
	TransportSlotCount	= TRANSPORTSLOTCOUNT_UNIT
;	MaxSimultaneousOfType	= 3						; Added for BFME2 Expansion

	WeaponSet
		Conditions 	= None
		Weapon 		= PRIMARY    MahudChiefWeapon
	End

	WeaponSet
		Conditions = PLAYER_UPGRADE
		Weapon = PRIMARY    MahudChiefWeaponLevel3
	End

	; WeaponSet
		; Conditions = WEAPONSET_TOGGLE_1
		; Weapon 		= PRIMARY	IsengardBerserkerSword
		; Weapon 		= SECONDARY	IsengardBerserkerTorch
		; OnlyAgainst 	= SECONDARY MINE
	; End

	; WeaponSet
		; Conditions = WEAPONSET_TOGGLE_1 PLAYER_UPGRADE
		; Weapon 		= PRIMARY	IsengardBerserkerSwordBlood
		; Weapon 		= SECONDARY	IsengardBerserkerTorch
		; OnlyAgainst 	= SECONDARY MINE
	; End

	ArmorSet
		Conditions      = None
		Armor           = MahudChiefArmor
		DamageFX        = NormalDamageFX
	End

  	; This is required so that the build phase lasts as long as the anim.
	BuildFadeInOnCreateTime = 2.0

	VisionRange = ISENGARD_BERSERKER_VISION_RANGE
	ShroudClearingRange = ISENGARD_BERSERKER_SHROUD_RANGE

	VisionSide = 35%
	VisionRear = 25%

	MaxVisionBonusPercent = 300%
	VisionBonusTestRadius = 200
	VisionBonusPercentPerFoot = 2.0%


	BountyValue 		= 125
	DisplayName 		= OBJECT:MahudChief
	DisplayNameStrategic 	= CONTROLBAR:LW_Unit_HaradwaithMahudChief
	CrushableLevel 		= 0  				; What am I?:        0 = for infantry, 1 = for trees, 2 = general vehicles
	CrusherLevel	 	= 0 				; What can I crush?: 0 = small animals, 1 = infantry, 2 = trees, 3 = vehicles
	CrushRevengeWeapon 	= BasicInfantryCrushRevenge

	CommandSet = MahudChiefCommandSet


	; *** AUDIO Parameters ***;

	VoiceAttack								= MahudChiefVoiceAttack
	VoiceAttackCharge						= MahudChiefVoiceAttackCharge
	VoiceAttackStructure 					= MahudChiefVoiceAttackBuilding
 	VoiceAttackMachine						= MahudChiefVoiceAttack
	VoiceCreated							= MahudChiefVoiceSalute
	VoiceFullyCreated						= MahudChiefVoiceSalute
	VoiceGuard								= MahudChiefVoiceMove
	VoiceMove								= MahudChiefVoiceMove
	VoiceMoveToCamp 						= MahudChiefVoiceMoveCamp
	VoiceMoveWhileAttacking					= MahudChiefVoiceDisengage
	VoicePriority							= 53
	VoiceRetreatToCastle 					= MahudChiefVoiceRetreat
	VoiceSelect								= MahudChiefVoiceSelectMS
	VoiceSelectBattle						= MahudChiefVoiceSelectBattle

	VoiceEnterStateAttack 					= MahudChiefVoiceEnterStateAttack
	VoiceEnterStateAttackCharge 			= MahudChiefVoiceEnterStateAttackCharge
	VoiceEnterStateAttackStructure	 		= MahudChiefVoiceEnterStateAttackBuilding
	VoiceEnterStateAttackMachine 			= MahudChiefVoiceEnterStateAttack
	VoiceEnterStateMove 					= MahudChiefVoiceEnterStateMove
	VoiceEnterStateMoveToCamp 				= MahudChiefVoiceEnterStateMoveCamp
	VoiceEnterStateMoveWhileAttacking		= MahudChiefVoiceEnterStateDisengage
	VoiceEnterStateRetreatToCastle	 		= MahudChiefVoiceEnterStateRetreat

	UnitSpecificSounds
		VoiceEnter				= MahudChiefVoiceGarrison				;for entering SiegeLadder
		VoiceEnterUnitEvilMenTransportShip	= MahudChiefVoiceGarrison
		VoiceEnterUnitMordorMumakil		= MahudChiefVoiceGarrison
		VoiceEnterUnitSlaughterHouse		= MahudChiefVoiceGarrison
		VoiceGarrison				= MahudChiefVoiceGarrison
		VoiceInitiateCaptureBuilding		= MahudChiefVoiceMove
	End

	CrowdResponseKey = Mahud ;EvilMen1

    #include "..\..\..\includes\StandardUnitEvaEvents.inc"

	ClientBehavior = ModelConditionAudioLoopClientBehavior ModuleTag_foo
		ModelCondition = Required:EMOTION_CELEBRATING	Excluded:DYING ENGAGED	Sound:EmotionMahudVoxCheerLoop	;MOVING ATTACKING
		ModelCondition = Required:EMOTION_TAUNTING		Excluded:DYING ENGAGED	Sound:EmotionMahudVoxTauntLoop	;MOVING ATTACKING
		ModelCondition = Required:EMOTION_POINTING		Excluded:DYING ENGAGED	Sound:EmotionMahudVoxTauntLoop
		ModelCondition = Required:RAISING_FLAG			Excluded:DYING ENGAGED	Sound:EmotionMahudVoxTauntLoop
	End

	Behavior = LargeGroupAudioUpdate ModuleTag_LGAU					;Tie into LargeGroupAudio system
		Key = Humanoid_Male Man Man_Male Mahuddin ;Haradrim_Lancer
	End

	ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
		MaxUpdateRangeCap = 800
		AnimationSound = Sound:FootstepDirtA			Animation:KUKng_SKL.KUKng_RUNA		Frames:4 15			;;,;; ;;; Previously FootstepDirtA
		AnimationSound = Sound:FootstepDirtA			Animation:KUKng_SKL.KUKng_RUNB		Frames:5 15 26 36	;;,;; ;;; Previously FootstepDirtA
		AnimationSound = Sound:TauntHumanHitShield		Animation:KUKng_SKL.KUKng_CHRB		Frames:22 32
		AnimationSound = Sound:BodyFallGenericNoArmor	Animation:KUKng_SKL.KUKng_DIEA		Frames:48
		AnimationSound = Sound:BodyFallGenericNoArmor	Animation:KUKng_SKL.KUKng_DIEB		Frames:18
		AnimationSound = Sound:BodyFallSoldier			Animation:KUKng_SKL.KUKng_LNDA		Frames:4
	End


	; *** ENGINEERING Parameters ***

	RadarPriority = UNIT
	KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY SCORE CAN_USE_SIEGE_TOWER MINE_TRIGGER ARMY_SUMMARY HEAVY_MELEE_HITTER CAN_ATTACK AIRCRAFT_PATH_AROUND ; GRAB_AND_DROP

 ;;.;; Added
	Behavior = AutoHealBehavior ModuleTag_BerserkerHealing
		StartsActive = No
		TriggeredBy = Upgrade_ObjectLevel2
		HealingAmount = 20
		HealingDelay = 1000
		StartHealingDelay = HERO_HEAL_DELAY
		HealOnlyIfNotInCombat = Yes
	End
;;.;;


	Body = ActiveBody ModuleTag_02
		MaxHealth         	= 1500 ;800				;BALANCE Uruk Hai Health
		MaxHealthDamaged  	= 700 ;ISENGARD_BERSERKER_HEALTH_DAMAGED
		BurningDeathBehavior	= Yes
		BurningDeathFX		= FX_InfantryBurningFlame
		CheerRadius		= EMOTION_CHEER_RADIUS
    	DodgePercent      = 80%

;; TAKEN OUT BY DESIGN... DON'T PUT THIS BACK...10/2004
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;    	DamagedAttributeModifier = BerserkerDamagedAttributeModifier
;   	ReallyDamagedAttributeModifier = BerserkerReallyDamagedAttributeModifier
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

	End

	Behavior = StancesBehavior ModuleTag_StancesBehavior
       	StanceTemplate = Hero ;;,;; FighterHorde
   	End

	#include "..\..\..\includes\CaptureBuilding.inc"

	;Wambly's Notes - Removed attack buildings command, unit should properly respect combat priorities now

	Behavior = AIUpdateInterface ModuleTag_03
		AutoAcquireEnemiesWhenIdle 	= 	Yes
		;AutoAcquireEnemiesWhenIdle 	= 	Yes ATTACK_BUILDINGS
		MoodAttackCheckRate        	= 	500
		AILuaEventsList			=	IsengardBeserkerFunctions
		AttackPriority			= 	AttackPriority_Infantry
		BurningDeathTime		=	BURNINGDEATH_DURATION_INFANTRY
	End

	Behavior = EmotionTrackerUpdate	Module_EmotionTracker	;;,;; Uncommented for 3.0.0
		TauntAndPointDistance		=	400		; max distance to taunted/pointed objet
		TauntAndPointUpdateDelay	=	1000		; how often scan (milliseconds)
		TauntAndPointExcluded		=	NONE
		AfraidOf			=	AOTR_EMOTION_AFRAIDOF_OBJECTFILTER
		AlwaysAfraidOf			=	EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
		PointAt				=	EMOTION_POINTAT_OBJECTFILTER
		HeroScanDistance		=	150
		FearScanDistance		=	200
		AddEmotion			=	Terror_Base
		AddEmotion			=	Doom_Base
		AddEmotion			=   	BraceForBeingCrushed_Base
		AddEmotion			=	UncontrollableFear_Base_Evil
		AddEmotion			=	FearIdle_Base
		AddEmotion			=	FearBusy_Base
		AddEmotion			=	Point_Base
		AddEmotion			=	Taunt_Base
		AddEmotion			=	CheerIdle_Base
		AddEmotion			=	CheerBusy_Base
		AddEmotion			=	HeroCheerIdle_Base
		AddEmotion			=	HeroCheerBusy_Base
		AddEmotion			=	Alert_Base
	End

	LocomotorSet
		Locomotor     = BerserkerLocomotor		; HumanLocomotor
		Condition     = SET_NORMAL
		Speed         = NORMAL_FOOT_FAST_MEMBER_SPEED
	End

	LocomotorSet
		Locomotor     = BerserkerLocomotor
		Condition     = SET_WANDER
		Speed         = NORMAL_FOOT_FAST_MEMBER_SPEED
	End

	LocomotorSet	;;,;; Uncommented - perhaps to fix invulnerable Berserker bug?
		Locomotor = BurningDeathLocomotorInfantry
		Condition = SET_BURNINGDEATH
		Speed	  = BURNINGDEATH_WANDERSPEED_INFANTRY
	End

	Behavior = PhysicsBehavior ModuleTag_04
		GravityMult = 1.0
	End

	; ;;; TOGGLE TORCH WEAPON SPECAIL POWER ;;;
	; Behavior = WeaponChangeSpecialPowerModule THING
		; SpecialPowerTemplate 	= SpecialAbilityBerserkerLightTorch
		; FlagsUsedForToggle	= WEAPONSET_TOGGLE_1
		; ToggleOnSleepFrames 	= 25
		; ToggleOffSleepFrames 	= 0
		; ToggleOnAttributeModifier = BerserkerTorchLightingPenalty
	; End

    ; Behavior = ObjectCreationUpgrade ModuleTag_RemoveUpgrades1
		; TriggeredBy = Upgrade_MiniHordeLvl3 ;when using torch
		; RemoveUpgrade = Upgrade_MiniHordeLvl2 ;when not using torch
    ; End
    ; Behavior = ObjectCreationUpgrade ModuleTag_RemoveUpgrades2
		; TriggeredBy = Upgrade_MiniHordeLvl2 ;when not using torch
		; RemoveUpgrade = Upgrade_MiniHordeLvl3 ;when using torch
    ; End
	; Behavior = SubObjectsUpgrade Show_Torch
		; TriggeredBy		= Upgrade_MiniHordeLvl3
		; ShowSubObjects	= TORCH
	; End
	; Behavior = SubObjectsUpgrade Hide_Torch
		; TriggeredBy		= Upgrade_MiniHordeLvl2
		; HideSubObjects	= TORCH
	; End

	Behavior = SlowDeathBehavior ModuleTag_05
		DeathTypes 		= ALL
		SinkDelay 		= 4000
		SinkRate 		= 1.0     				; in Dist/Sec
		DestructionDelay 	= 10000
		Sound 			= INITIAL MahudChiefVoiceDie			; BerserkerVoiceDie
	End
;------------------Hearts of fire reflect damage--------------------------------------------------------------------------------
  	Behavior = AttributeModifierUpgrade ModuleTag_HoFVisual
		TriggeredBy = Upgrade_SindarinHeavyArmor
		AttributeModifier = ZigurCultistsHeartsofFireVisual
	End
	
  	Behavior = FireWeaponWhenDamagedBehavior SerratedArmor
		StartsActive				= No
		TriggeredBy					= Upgrade_SindarinHeavyArmor
		Permanent 					= Yes
		ReactionWeaponPristine 		= HeartsOfFireReflectWeapon
		ReactionWeaponDamaged		= HeartsOfFireReflectWeapon
		ReactionWeaponReallyDamaged	= HeartsOfFireReflectWeapon
		DamageTypes					= ALL -PIERCE -FLAME -MAGIC -FROST -STRUCTURAL -UNDEFINED -HERO_RANGED -POISON
		DamageAmount				= 1
	End
;------------------------------------------------------------------------------------------------------------------------------
	Behavior = SquishCollide ModuleTag_06
		;nothing
	End

	Behavior = HordeMemberCollide ModuleTag_HMC				; Added for BFME2 Expansion
		;nothing
	End

	Behavior = ProductionUpdate ProductionUpdateModuleTag
		GiveNoXP = Yes
	End

	;-------------------------------------------------------------------------
	;Tame the Beast
	;-------------------------------------------------------------------------
 	Behavior = UnpauseSpecialPowerUpgrade ModuleTag_WildAllegianceEnabler
		SpecialPowerTemplate		= SpecialAbilityTametheBeast
		TriggeredBy					= Upgrade_ObjectLevel1
	End
	Behavior = SpecialPowerModule ModuleTag_DominateEnemySpecialPowerModule
		SpecialPowerTemplate		= SpecialAbilityTametheBeast
		StartsPaused				= Yes
		UpdateModuleStartsAttack	= Yes
	;	InitiateSound				= SarumanVoiceDominate
	End
 	Behavior = DominateEnemySpecialPower ModuleTag_DominateEnemySpecialPower
    SpecialPowerTemplate		= SpecialAbilityTametheBeast
		UnpackingVariation			= 1
		StartAbilityRange			= 275.0 ;;,;; 200.0

;;,;;		AttributeModifierAffects	= ALL -DOZER -HERO -STRUCTURE -ARMY_OF_DEAD -MOVE_ONLY -AngmarThrallMaster ENEMIES NEUTRAL

		AttributeModifierAffects	= ANY +WhiteWolfLair +WildWhiteWarg_Slave +NeutralJungleWarg +WargJungleLair +NeutralScorpion +GiantScorpionLair +HaradGiantScorpion_Creep +ScorpionDen +AOTRKaraddLair +NeutralKaradd_Slaved +LossothLair +AOTRLossoth_Slaved +WildSnowTroll_Slaved +WildHillTroll_Slaved +WildHillTroll_Slaved +WildStoneTroll_Slaved  +AOTRJungleTroll_Slaved +WildMammoth +WildOliphaunt +WildHillTrollLair +WildHillTrollLairSnow +WildStoneTrollLair +WildStoneTrollLairSnow +AOTRJungleTrollLair +WildSnowTrollLair +WildSnowTrollLairSnow +SnowTrollLair +HillTrollLair +SnowTrollLairSnow +HillTrollLairSnow +CaveTrollLair +MoriarGoblinLair +WargLair +SpiderLair +BarrowWightLair +FireDrakeLair +MoriarGoblinLairSnow +CaveTrollLairSnow +NeutralWarg +BarrowWight_Slaved +FireDrake_Slaved +MordorGoblinSwordsman_Slaved +MordorGoblinArcher_Slaved +MinorSpider_Slaved +CaveTroll_Slaved ENEMIES NEUTRAL

		DominateRadius				= 100 ;;,;; 60 ;100 ;150
		DominatedFX					= FX_MahudTametheBeastTargets
		TriggerFX					= FX_MahudTametheBeastTrigger

		UnpackTime					= 1200 ;;,;; 2000
		PreparationTime				= 1
		FreezeAfterTriggerDuration	= 2500 ; Hold AI for this long after we fire.
		PermanentlyConvert	= Yes ; No ;;,;; Added for 2.3
    End
	Behavior = AutoAbilityBehavior ModuleTag_DominateEnemyAutoAbility ;;,;;
		SpecialAbility				= SpecialAbilityTametheBeast
		ForbiddenStatus = INSIDE_GARRISON ;;,;; This seems to prevent the ability from being used inside a tower
		MaxScanRange				= 200
		Query						= 10 ALL ENEMIES -STRUCTURE -WALL_UPGRADE -WALL_HUB -WALL_SEGMENT -DEFENSIVE_WALL -FS_BASE_DEFENSE ;;,;;
;;,;;		Query						= 1 ALL ENEMIES -STRUCTURE
	End
	;-----------------------------------------------------------------------------
	;-----------------------------------------------------------------------------
	; COMMANDSET CHANGES
	;-----------------------------------------------------------------------------
	 Behavior = CommandSetUpgrade ModueTag_CommandSetLvl5
         TriggeredBy              	= Upgrade_RoacLevel3
         CommandSet               	= MahudChiefCommandSetTametheBeast
	 End
    ;---------------------------------------------------------------------------
	 	Behavior = UntamedAllegianceSpecialPower ModuleTag_UntamedAllegiance  		;;.;;Original UA behavior
		SpecialPowerTemplate		= SpecialAbilityTametheBeast
;		TargetEnemy					= Yes
		AttributeModifierAffects	= AOTR_CREEP_OBJECTFILTER ;CREEP_OBJECTFILTER
		AttributeModifierRange		= 60 ;,; 100 ;,; 60
		TriggerFX					= FX_SarumanDominateTrigger
	End
	;-------------------------------------------------------------------------
	; Chieftain's Banner
	;-------------------------------------------------------------------------
	; Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
		; TriggeredBy = Upgrade_IsengardBerserkerMansblood
	; End
	Behavior = WeaponSetUpgrade WeaponSetUpgradeModuleTag
		TriggeredBy		= Upgrade_ObjectLevel3
	End
	; Behavior = SubObjectsUpgrade Blood_Upgrade
		; TriggeredBy	= Upgrade_IsengardBerserkerMansblood
		; UpgradeTexture	= iuNberserk.tga 0 iuNberserkHA.tga
		; RecolorHouse	= Yes
	; End
 	;-------------------------------------------------------------------------
	; Chieftain's Banner cost reduction
	;-------------------------------------------------------------------------
	Behavior = CostModifierUpgrade ModuleTag_CostModifier
;		LabelForPalantirString = GUI:URUKDiscount
		StartsActive = Yes ; Run on build complete, not upgrade
		ObjectFilter	= ANY +MordorMumakil +HaradSiegeMumak
 ;       Percentage        = 0%
        Percentage        = -5%
        Percentage        = -10%
        Percentage        = -15%
        Percentage        = -20%
	End
  	; ;-------------------------------------------------------------------------
	; ; Iron Fist
	; ;-------------------------------------------------------------------------
	; Behavior = SubObjectsUpgrade Crest_Upgrade
		; TriggeredBy		= Upgrade_IsengardBerserkerIronFist
		; RecolorHouse	= Yes
		; ShowSubObjects	= CREST
	; End
	; Behavior = AttributeModifierAuraUpdate ModuleTag_FearMe
		; StartsActive	= No ;If no, requires upgrade to turn on.
		; TriggeredBy 	= Upgrade_IsengardBerserkerIronFist
		; BonusName		= BerserkerLeadership
		; RefreshDelay	= 1000
		; Range			= 100
		; ObjectFilter	= ANY +URUK -HERO
	; End
	; ;-------------------------------------------------------------------------
	;---------------------------------------------------------------
	;	GLISTENING DOWN
	;---------------------------------------------------------------
	Behavior = AttributeModifierUpgrade ModuleTag_GlisteningDownBonus
		TriggeredBy			= Upgrade_PurchaseFellBeast
		AttributeModifier	= GlisteningDownBonus
	End
	;---------------------------------------------------------------

	/////////////////////
	// AISpecialPowers
	/////////////////////

	Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
		CommandButtonName = Command_SetStanceBattle
		SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
	End

	Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive ;;,;; Changed for 3.0.1
		CommandButtonName = Command_AttackMove ;;,;; Command_SetStanceAggressive ;;,;; Changed for 3.0.1
		SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
	End

	Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
		CommandButtonName = Command_SetStanceHoldGround
		SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
	End


	Behavior = AISpecialPowerUpdate IsengardBerserkerCaptureBuildingAI
		CommandButtonName = Command_CaptureBuilding
		SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
	End

	Geometry = CYLINDER
	GeometryMajorRadius = 8.0
	GeometryMinorRadius = 8.0
	GeometryHeight = 19.2
	GeometryIsSmall = Yes
	Shadow = SHADOW_DECAL
	ShadowSizeX = 19;
	ShadowSizeY = 19;
	ShadowTexture = ShadowI;


	// *** AUTO RESOLVE DATA ***
	AutoResolveUnitType = AutoResolveUnit_Soldier
	AutoResolveCombatChain = AutoResolve_SoldierCombatChain

	AutoResolveBody = Aotr_AutoResolve_SoldierEliteSingleHordeBody

	AutoResolveArmor
		Armor = Aotr_AutoResolve_EliteSoldierArmor
	End

	AutoResolveWeapon
		Weapon = AutoResolve_EliteInfantrySingleWeapon
	End
	
	AutoResolveLeadership = AutoResolve_MahudChiefBonus
	
End
;---------------------------------------------------------------------------------------------

Object MahudChieffBuffEgg

	Draw = W3DScriptedModelDraw ModuleTag_Draw
		DefaultModelConditionState
			Model = None
		End
	End

	KindOf = INERT IMMOBILE UNATTACKABLE

	Body = ActiveBody ModuleTag_MakesKillWork
		MaxHealth = 1
	End

	Behavior = LifetimeUpdate ModuleTag_HatchTrigger
		MinLifetime = 1000
		MaxLifetime = 1000
	End

	Behavior = AttributeModifierAuraUpdate ModuleTag_GrimResolve
		StartsActive	= Yes ;If no, requires upgrade to turn on.
		BonusName		= MahudChieffBuff
		RefreshDelay	= 2000
		Range			= 200
		ObjectFilter	= NONE +HaradMahudHeadhunter  +HaradMahudWarrior +MahudSpear
	End

End
Object MahudChieffBuffLevel3Egg

	Draw = W3DScriptedModelDraw ModuleTag_Draw
		DefaultModelConditionState
			Model = None
		End
	End

	KindOf = INERT IMMOBILE UNATTACKABLE

	Body = ActiveBody ModuleTag_MakesKillWork
		MaxHealth = 1
	End

	Behavior = LifetimeUpdate ModuleTag_HatchTrigger
		MinLifetime = 1000
		MaxLifetime = 1000
	End

	Behavior = AttributeModifierAuraUpdate ModuleTag_GrimResolve
		StartsActive	= Yes ;If no, requires upgrade to turn on.
		BonusName		= MahudChieffBuff
		RefreshDelay	= 2000
		Range			= 200
		ObjectFilter	= NONE +HaradMahudHeadhunter  +HaradMahudWarrior +MahudSpear
	End

	Behavior = AttributeModifierAuraUpdate ModuleTag_GrimResolve2
		StartsActive	= Yes ;If no, requires upgrade to turn on.
		BonusName		= MahudChieffBuffLevel3
		RefreshDelay	= 2000
		Range			= 200
		ObjectFilter	= NONE +HaradMahudHeadhunter  +HaradMahudWarrior +MahudSpear
	End

End

;------------------------------------------------------------------------------
;------------------------------------------------------------------------------
;------------------------------------------------------------------------------
ChildObject MahudMasteryChief MahudChief
;	EquivalentTo	= MahudChief
	Scale = 1.15
	; *** ART Parameters ***

	; This is required for garrisoned objects - please put in all objects.
	ButtonImage				= uimahudchief
	SelectPortrait			= UPMahudChief

	DescriptionStrategic = CONTROLBAR:LW_ToolTip_HaradwaithMahudChief

	Draw = W3DScriptedModelDraw ModuleTag_01

	  OkToChangeModelColor = Yes
	  	StaticModelLODMode = Yes

		DefaultModelConditionState
			Model = humachief_skn
		End

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

		AnimationState			= PACKING_TYPE_1
			StateName		= SPELL
			Animation
				AnimationName     = KUKng_SKL.KUKng_SPCA
				AnimationMode     = ONCE
			End
		End

		AnimationState			= PACKING_TYPE_2
			StateName		= SPELL
			Animation
				AnimationName     = KUKng_SKL.KUKng_LVLA
				AnimationMode     = ONCE
			End
			FXEvent	= Frame:30 Name: FX_UglukHeadHuntStart
		End

		IdleAnimationState
			StateName				= Idle
			Animation
				AnimationName       = KUKng_SKL.KUKng_IDLB
				AnimationPriority	= 4
				AnimationBlendTime	= 10
				AnimationMode       = ONCE
			End
			Animation
				AnimationName       = KUKng_SKL.KUKng_IDLC
				AnimationPriority	= 1
				AnimationBlendTime	= 10
				AnimationMode       = ONCE
			End
			Animation
				AnimationName       = KUKng_SKL.KUKng_IDLD
				AnimationPriority = 1
				AnimationBlendTime	= 10
				AnimationMode       = ONCE
			End
			Animation
				AnimationName       = KUKng_SKL.KUKng_IDLE
				AnimationPriority = 1
				AnimationBlendTime	= 10
				AnimationMode       = ONCE
			End
			Flags				=	RESTART_ANIM_WHEN_COMPLETE
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Selected" then CurDrawableSetTransitionAnimState("TRANS_Selected_to_Idle") end
			EndScript
		End

		AnimationState				=	DYING BURNINGDEATH
			Animation
				AnimationName		=	KUKng_SKL.KUKng_DTHA
				AnimationMode		=	ONCE
				AnimationBlendTime	=	10
			End
		End


		AnimationState = DYING
			Animation
				AnimationName       = KUKng_SKL.KUKng_DTHA
				AnimationMode       = ONCE
			End
		End

		AnimationState				=	BURNINGDEATH
			Animation
				AnimationName		=	KUKng_SKL.KUKng_MFDA
				AnimationMode		=	LOOP
				Distance			=	90
			End
		End

		AnimationState = FREEFALL
			Animation
				AnimationName = KUKng_SKL.KUKng_FLYA
				AnimationMode = LOOP
			End
			Flags = RANDOMSTART
		End

		AnimationState = STUNNED_FLAILING
			Animation
				AnimationName = KUKng_SKL.KUKng_FLYA
				AnimationMode = LOOP
				AnimationSpeedFactorRange	= 0.4 0.6
			End
			Flags = RANDOMSTART
		End

		AnimationState				=	DYING SPLATTED
			Animation
				AnimationName		=	KUKng_SKL.KUKng_LNDA
				AnimationMode		=	ONCE
			End
		End

		AnimationState = STUNNED_STANDING_UP
			Animation
				AnimationName = KUKng_SKL.KUKng_GTPA
				AnimationMode = ONCE
			End
		End

		AnimationState			= STUNNED
			Animation
				AnimationName   = KUKng_SKL.KUKng_LNDA
				AnimationMode   = ONCE
			End
		End

;-----------------
		AnimationState = MOVING FIRING_OR_PREATTACK_A GARRISONED
			Animation
				AnimationName = KUKng_SKL.KUKng_CHRA
				AnimationMode = LOOP
			End

			Flags = RESTART_ANIM_WHEN_COMPLETE
		End
;-----------------

		AnimationState = MOVING FIRING_OR_PREATTACK_A
			Animation
				AnimationName = KUKng_SKL.KUKng_RUNB
				AnimationMode = LOOP
			End

			Flags = RESTART_ANIM_WHEN_COMPLETE
		End

		AnimationState = FIRING_OR_PREATTACK_A
			Animation
				AnimationName = KUKng_SKL.KUKng_ATKA
				AnimationMode = ONCE
			End
			Animation
				AnimationName = KUKng_SKL.KUKng_ATKB
				AnimationMode = ONCE
			End
			Animation
				AnimationName = KUKng_SKL.KUKng_ATKC
				AnimationMode = ONCE
			End
			Animation
				AnimationName = KUKng_SKL.KUKng_SPCB
				AnimationMode = ONCE
			End
		End

;------------
		AnimationState = MOVING GARRISONED
			Animation
				AnimationName = KUKng_SKL.KUKng_CHRA
				AnimationMode = LOOP
			End
			Flags = RESTART_ANIM_WHEN_COMPLETE
		End
;-----------
		AnimationState = MOVING
			Animation
				AnimationName = KUKng_SKL.KUKng_RUNB
				AnimationMode = LOOP
			End
			Flags = RESTART_ANIM_WHEN_COMPLETE
		End

		; --------- Click and Hit Reactions ------------
		AnimationState = HIT_REACTION HIT_LEVEL_1
			Animation = Hit_Level_1_a
				AnimationName = KUKng_SKL.KUKng_HITA
				AnimationMode = ONCE
			End
		End

		AnimationState = LEVELED
			Animation = Hit_Level_1_a
				AnimationName = KUKng_SKL.KUKng_LVLA
				AnimationMode = ONCE
			End
		End

		AnimationState = ENGAGED
			Animation
				AnimationName = KUKng_SKL.KUKng_APPA
				AnimationMode = LOOP
			End
		End


		AnimationState = EMOTION_CELEBRATING
			Animation
				AnimationName = KUKng_SKL.KUKng_CHRA
				AnimationMode = LOOP
			End
		End

		AnimationState							= EMOTION_TAUNTING
			Animation							= TNTA
				AnimationName					= KUKng_SKL.KUKng_TNTA
				AnimationMode					= ONCE
				AnimationSpeedFactorRange		= 0.8 1.2
			End
			Flags				=	RESTART_ANIM_WHEN_COMPLETE
		End

		AnimationState = RAISING_FLAG
			Animation
				AnimationName = KUKng_SKL.KUKng_CHRA
				AnimationMode = LOOP
			End
		End

		AnimationState = SELECTED
			Animation
				AnimationName = KUKng_SKL.KUKng_ATNB
				AnimationMode = LOOP
			End
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Idle" then CurDrawableSetTransitionAnimState("TRANS_Idle_to_Selected") end
			EndScript
		End

    	TransitionState = TRANS_Idle_to_Selected
		Animation = ATNA
			AnimationName		= KUKng_SKL.KUKng_ATNA
			AnimationMode		= ONCE
			AnimationBlendTime	= 10
		End
    	End

    	TransitionState = TRANS_Selected_to_Idle
		Animation = ATNF
			AnimationName		= KUKng_SKL.KUKng_ATNC
			AnimationMode		= ONCE
			AnimationBlendTime	= 10
		End
    	End


		; --- Morgul Blade Weapon anim
		AnimationState        = SPECIAL_WEAPON_ONE
			StateName		= Attacking
			Animation             = SPCB
				AnimationName       = KUKng_SKL.KUKng_SPCB
				AnimationMode       = ONCE
			End
		End

		AnimationState			= SPECIAL_POWER_1
			StateName		= SPECIAL_POWER_1
			Animation
				AnimationName     = KUKng_SKL.KUKng_SPCD
				AnimationMode     = ONCE
			End
		End

		AnimationState			= SPECIAL_POWER_2
			StateName		= SPECIAL_POWER_2
			Animation
				AnimationName     = KUKng_SKL.KUKng_SPCA
				AnimationMode     = ONCE
			End
		End

	End

    #include "..\..\..\includes\StunDrawModuleSmall.inc"

	; ***DESIGN parameters ***
	Side			= Angmar
	EditorSorting		= UNIT

	ThreatLevel		= ISENGARD_BESERKER_THREAT_LEVEL
	ThreatBreakdown 	= IsengardBeserker_DetailedThreat
		AIKindOf 	= INFANTRY
	End

	ThingClass		= HORDE_UNIT
	CommandPoints		= 0 ;;,;; 30 ;;,;; 25
	BuildCost		= 500 ;ISENGARD_BERSERKER_BUILDCOST
	BuildTime		= ISENGARD_BERSERKER_BUILDTIME
	TransportSlotCount	= TRANSPORTSLOTCOUNT_UNIT
;	MaxSimultaneousOfType	= 3						; Added for BFME2 Expansion

	WeaponSet
		Conditions 	= None
		Weapon 		= PRIMARY    MahudChiefWeapon
	End

	WeaponSet
		Conditions = PLAYER_UPGRADE
		Weapon = PRIMARY    MahudChiefWeaponLevel3
	End

	; WeaponSet
		; Conditions = WEAPONSET_TOGGLE_1
		; Weapon 		= PRIMARY	IsengardBerserkerSword
		; Weapon 		= SECONDARY	IsengardBerserkerTorch
		; OnlyAgainst 	= SECONDARY MINE
	; End

	; WeaponSet
		; Conditions = WEAPONSET_TOGGLE_1 PLAYER_UPGRADE
		; Weapon 		= PRIMARY	IsengardBerserkerSwordBlood
		; Weapon 		= SECONDARY	IsengardBerserkerTorch
		; OnlyAgainst 	= SECONDARY MINE
	; End

	ArmorSet
		Conditions      = None
		Armor           = MahudChiefArmor
		DamageFX        = NormalDamageFX
	End

  	; This is required so that the build phase lasts as long as the anim.
	BuildFadeInOnCreateTime = 2.0

	VisionRange = ISENGARD_BERSERKER_VISION_RANGE
	ShroudClearingRange = ISENGARD_BERSERKER_SHROUD_RANGE

	VisionSide = 35%
	VisionRear = 25%

	MaxVisionBonusPercent = 300%
	VisionBonusTestRadius = 200
	VisionBonusPercentPerFoot = 2.0%


	BountyValue 		= 125
	DisplayName 		= OBJECT:MahudChief
	CrushableLevel 		= 0  				; What am I?:        0 = for infantry, 1 = for trees, 2 = general vehicles
	CrusherLevel	 	= 0 				; What can I crush?: 0 = small animals, 1 = infantry, 2 = trees, 3 = vehicles
	CrushRevengeWeapon 	= BasicInfantryCrushRevenge

	CommandSet = MahudChiefCommandSet


	; *** AUDIO Parameters ***;

	VoiceAttack								= MahudChiefVoiceAttack
	VoiceAttackCharge						= MahudChiefVoiceAttackCharge
	VoiceAttackStructure 					= MahudChiefVoiceAttackBuilding
 	VoiceAttackMachine						= MahudChiefVoiceAttack
	VoiceCreated							= MahudChiefVoiceSalute
	VoiceFullyCreated						= MahudChiefVoiceSalute
	VoiceGuard								= MahudChiefVoiceMove
	VoiceMove								= MahudChiefVoiceMove
	VoiceMoveToCamp 						= MahudChiefVoiceMoveCamp
	VoiceMoveWhileAttacking					= MahudChiefVoiceDisengage
	VoicePriority							= 53
	VoiceRetreatToCastle 					= MahudChiefVoiceRetreat
	VoiceSelect								= MahudChiefVoiceSelectMS
	VoiceSelectBattle						= MahudChiefVoiceSelectBattle

	VoiceEnterStateAttack 					= MahudChiefVoiceEnterStateAttack
	VoiceEnterStateAttackCharge 			= MahudChiefVoiceEnterStateAttackCharge
	VoiceEnterStateAttackStructure	 		= MahudChiefVoiceEnterStateAttackBuilding
	VoiceEnterStateAttackMachine 			= MahudChiefVoiceEnterStateAttack
	VoiceEnterStateMove 					= MahudChiefVoiceEnterStateMove
	VoiceEnterStateMoveToCamp 				= MahudChiefVoiceEnterStateMoveCamp
	VoiceEnterStateMoveWhileAttacking		= MahudChiefVoiceEnterStateDisengage
	VoiceEnterStateRetreatToCastle	 		= MahudChiefVoiceEnterStateRetreat

	UnitSpecificSounds
		VoiceEnter				= MahudChiefVoiceGarrison				;for entering SiegeLadder
		VoiceEnterUnitEvilMenTransportShip	= MahudChiefVoiceGarrison
		VoiceEnterUnitMordorMumakil		= MahudChiefVoiceGarrison
		VoiceEnterUnitSlaughterHouse		= MahudChiefVoiceGarrison
		VoiceGarrison				= MahudChiefVoiceGarrison
		VoiceInitiateCaptureBuilding		= MahudChiefVoiceMove
	End

	CrowdResponseKey = Mahud ;EvilMen1

    #include "..\..\..\includes\StandardUnitEvaEvents.inc"

	ClientBehavior = ModelConditionAudioLoopClientBehavior ModuleTag_foo
		ModelCondition = Required:EMOTION_CELEBRATING	Excluded:DYING ENGAGED	Sound:EmotionMenEvilCompilationVoxCheerSinglesLoop	;MOVING ATTACKING
		ModelCondition = Required:EMOTION_TAUNTING		Excluded:DYING ENGAGED	Sound:EmotionMenEvilCompilationVoxTauntSinglesLoop	;MOVING ATTACKING
		ModelCondition = Required:EMOTION_POINTING		Excluded:DYING ENGAGED	Sound:EmotionMenEvilCompilationVoxTauntSinglesLoop
		ModelCondition = Required:RAISING_FLAG			Excluded:DYING ENGAGED	Sound:EmotionMenEvilCompilationVoxTauntSinglesLoop
	End

	Behavior = LargeGroupAudioUpdate ModuleTag_LGAU					;Tie into LargeGroupAudio system
		Key = Humanoid_Male Man Man_Male Mahuddin ;Haradrim_Lancer
	End

	ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
		MaxUpdateRangeCap = 800
		AnimationSound = Sound:FootstepDirtA			Animation:KUKng_SKL.KUKng_RUNA		Frames:4 15			;;,;; ;;; Previously FootstepDirtA
		AnimationSound = Sound:FootstepDirtA			Animation:KUKng_SKL.KUKng_RUNB		Frames:5 15 26 36	;;,;; ;;; Previously FootstepDirtA
		AnimationSound = Sound:TauntHumanHitShield		Animation:KUKng_SKL.KUKng_CHRB		Frames:22 32
		AnimationSound = Sound:BodyFallGenericNoArmor	Animation:KUKng_SKL.KUKng_DIEA		Frames:48
		AnimationSound = Sound:BodyFallGenericNoArmor	Animation:KUKng_SKL.KUKng_DIEB		Frames:18
		AnimationSound = Sound:BodyFallSoldier			Animation:KUKng_SKL.KUKng_LNDA		Frames:4
	End


	; *** ENGINEERING Parameters ***

	RadarPriority = UNIT
	KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY SCORE CAN_USE_SIEGE_TOWER CAN_RIDE_SIEGE_LADDER MINE_TRIGGER ARMY_SUMMARY GRAB_AND_DROP HEAVY_MELEE_HITTER CAN_ATTACK AIRCRAFT_PATH_AROUND

 ;;.;; Added
	Behavior = AutoHealBehavior ModuleTag_BerserkerHealing
		StartsActive = No
		TriggeredBy = Upgrade_ObjectLevel2
		HealingAmount = 20
		HealingDelay = 1000
		StartHealingDelay = HERO_HEAL_DELAY
		HealOnlyIfNotInCombat = Yes
	End
;;.;;


	Body = ActiveBody ModuleTag_02
		MaxHealth         	= 1500 ;800				;BALANCE Uruk Hai Health
		MaxHealthDamaged  	= 700 ;ISENGARD_BERSERKER_HEALTH_DAMAGED
		BurningDeathBehavior	= Yes
		BurningDeathFX		= FX_InfantryBurningFlame
		CheerRadius		= EMOTION_CHEER_RADIUS
    	DodgePercent      = 80%

;; TAKEN OUT BY DESIGN... DON'T PUT THIS BACK...10/2004
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;    	DamagedAttributeModifier = BerserkerDamagedAttributeModifier
;   	ReallyDamagedAttributeModifier = BerserkerReallyDamagedAttributeModifier
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

	End

	Behavior = StancesBehavior ModuleTag_StancesBehavior
       	StanceTemplate = Hero ;;,;; FighterHorde
   	End

	#include "..\..\..\includes\CaptureBuilding.inc"

	;Wambly's Notes - Removed attack buildings command, unit should properly respect combat priorities now

	Behavior = AIUpdateInterface ModuleTag_03
		AutoAcquireEnemiesWhenIdle 	= 	Yes
		;AutoAcquireEnemiesWhenIdle 	= 	Yes ATTACK_BUILDINGS
		MoodAttackCheckRate        	= 	500
		AILuaEventsList			=	IsengardBeserkerFunctions
		AttackPriority			= 	AttackPriority_Infantry
		BurningDeathTime		=	BURNINGDEATH_DURATION_INFANTRY
	End

	Behavior = EmotionTrackerUpdate	Module_EmotionTracker	;;,;; Uncommented for 3.0.0
		TauntAndPointDistance		=	400		; max distance to taunted/pointed objet
		TauntAndPointUpdateDelay	=	1000		; how often scan (milliseconds)
		TauntAndPointExcluded		=	NONE
		AfraidOf			=	AOTR_EMOTION_AFRAIDOF_OBJECTFILTER
		AlwaysAfraidOf			=	EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
		PointAt				=	EMOTION_POINTAT_OBJECTFILTER
		HeroScanDistance		=	150
		FearScanDistance		=	200
		AddEmotion			=	Terror_Base
		AddEmotion			=	Doom_Base
		AddEmotion			=   	BraceForBeingCrushed_Base
		AddEmotion			=	UncontrollableFear_Base_Evil
		AddEmotion			=	FearIdle_Base
		AddEmotion			=	FearBusy_Base
		AddEmotion			=	Point_Base
		AddEmotion			=	Taunt_Base
		AddEmotion			=	CheerIdle_Base
		AddEmotion			=	CheerBusy_Base
		AddEmotion			=	HeroCheerIdle_Base
		AddEmotion			=	HeroCheerBusy_Base
		AddEmotion			=	Alert_Base
	End

	LocomotorSet
		Locomotor     = BerserkerLocomotor		; HumanLocomotor
		Condition     = SET_NORMAL
		Speed         = NORMAL_FOOT_FAST_MEMBER_SPEED
	End

	LocomotorSet
		Locomotor     = BerserkerLocomotor
		Condition     = SET_WANDER
		Speed         = NORMAL_FOOT_FAST_MEMBER_SPEED
	End

	LocomotorSet	;;,;; Uncommented - perhaps to fix invulnerable Berserker bug?
		Locomotor = BurningDeathLocomotorInfantry
		Condition = SET_BURNINGDEATH
		Speed	  = BURNINGDEATH_WANDERSPEED_INFANTRY
	End

	Behavior = PhysicsBehavior ModuleTag_04
		GravityMult = 1.0
	End


	Behavior = SlowDeathBehavior ModuleTag_05
		DeathTypes 		= ALL
		SinkDelay 		= 4000
		SinkRate 		= 1.0     				; in Dist/Sec
		DestructionDelay 	= 10000
		Sound 			= INITIAL MahudChiefVoiceDie			; BerserkerVoiceDie
	End
;------------------Hearts of fire reflect damage--------------------------------------------------------------------------------
  	Behavior = AttributeModifierUpgrade ModuleTag_HoFVisual
		TriggeredBy = Upgrade_SindarinHeavyArmor
		AttributeModifier = ZigurCultistsHeartsofFireVisual
	End
	
  	Behavior = FireWeaponWhenDamagedBehavior SerratedArmor
		StartsActive				= No
		TriggeredBy					= Upgrade_SindarinHeavyArmor
		Permanent 					= Yes
		ReactionWeaponPristine 		= HeartsOfFireReflectWeapon
		ReactionWeaponDamaged		= HeartsOfFireReflectWeapon
		ReactionWeaponReallyDamaged	= HeartsOfFireReflectWeapon
		DamageTypes					= ALL -PIERCE -FLAME -MAGIC -FROST -STRUCTURAL -UNDEFINED -HERO_RANGED -POISON
		DamageAmount				= 1
	End
;------------------------------------------------------------------------------------------------------------------------------
	Behavior = SquishCollide ModuleTag_06
		;nothing
	End

	Behavior = HordeMemberCollide ModuleTag_HMC				; Added for BFME2 Expansion
		;nothing
	End

	Behavior = ProductionUpdate ProductionUpdateModuleTag
		GiveNoXP = Yes
	End


	/////////////////////
	// AISpecialPowers
	/////////////////////

	Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
		CommandButtonName = Command_SetStanceBattle
		SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
	End

	Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive ;;,;; Changed for 3.0.1
		CommandButtonName = Command_AttackMove ;;,;; Command_SetStanceAggressive ;;,;; Changed for 3.0.1
		SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
	End

	Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
		CommandButtonName = Command_SetStanceHoldGround
		SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
	End


	Behavior = AISpecialPowerUpdate IsengardBerserkerCaptureBuildingAI
		CommandButtonName = Command_CaptureBuilding
		SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
	End

	Geometry = CYLINDER
	GeometryMajorRadius = 8.0
	GeometryMinorRadius = 8.0
	GeometryHeight = 19.2
	GeometryIsSmall = Yes
	Shadow = SHADOW_DECAL
	ShadowSizeX = 19;
	ShadowSizeY = 19;
	ShadowTexture = ShadowI;


	// *** AUTO RESOLVE DATA ***
	AutoResolveUnitType = AutoResolveUnit_Soldier
	AutoResolveCombatChain = AutoResolve_SoldierCombatChain

	AutoResolveBody = AutoResolve_IsengardBeserkerBody

	AutoResolveArmor
		Armor = AutoResolve_IsengardBeserkerArmor
	End

	AutoResolveWeapon
		Weapon = AutoResolve_IsengardBeserkerWeapon
	End
End

ChildObject MahudChiefDriver MahudChief
;	EquivalentTo	= MahudChief
	; *** ART Parameters ***

	; This is required for garrisoned objects - please put in all objects.
	ButtonImage				= uimahudchief
	SelectPortrait			= UPMahudChief

	DescriptionStrategic = CONTROLBAR:LW_ToolTip_HaradwaithMahudChief

	Draw = W3DScriptedModelDraw ModuleTag_01

	  OkToChangeModelColor = Yes
	  	StaticModelLODMode = Yes

		DefaultModelConditionState
			Model = humachiefS_skn
			Skeleton            = RUPsnt_1_SKL
		End

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

		AnimationState						= PASSENGER
			Animation						= FLLA
				AnimationName				= RUPsnt_1_FLLA
				AnimationMode				= LOOP
			End
		End
		
		AnimationState        = THROWN_PROJECTILE
			Animation           = FLYA
				AnimationName     = RUPsnt_1_FLYA
				AnimationMode     = LOOP
			End
		End
		
		AnimationState						= FREEFALL
			Animation						= FLYA
				AnimationName				= RUPsnt_1_FLYA
				AnimationMode				= LOOP
				AnimationSpeedFactorRange	= 0.7	0.7
				AnimationBlendTime			= 10
			End
		End
		
		AnimationState        = STUNNED_FLAILING
			Animation           = FLYA
				AnimationName     = RUPsnt_1_FLYA
				AnimationMode      = LOOP
			End
			Flags               = RANDOMSTART
		End
	
		AnimationState        = DYING DEATH_2
			Animation           = DIEA
				AnimationName     = RUPsnt_1_IDLA
				AnimationMode     = ONCE
			End
			Animation           = DIEB
				AnimationName     = RUPsnt_1_IDLC
				AnimationMode     = ONCE
			End			
		End
	
		AnimationState						= DYING SPLATTED
			Animation						= LNDA
				AnimationName				= RUPsnt_1_LNDA
				AnimationMode				= ONCE
			End
		End
		
		AnimationState        = DYING
			Animation           = DIEA
				AnimationName     = RUPsnt_1_DIEA
				AnimationMode     = ONCE
			End
			Animation           = DIEB
				AnimationName     = RUPsnt_1_DIEB
				AnimationMode     = ONCE
			End			
		End

		AnimationState        = STUNNED_STANDING_UP
			Animation           = GTPA
				AnimationName     = RUPsnt_1_GTPA
				AnimationMode     = ONCE
				AnimationSpeedFactorRange = 1.5 1.5
			End
;			Animation           = GTPB
;				AnimationName     = RUPsnt_1_GTPB
;				AnimationMode     = ONCE
;                                AnimationSpeedFactorRange = 1.5 1.5
;			End			
		End
		
		AnimationState        = STUNNED
			Animation           = LNDA
				AnimationName     = RUPsnt_1_LNDA
				AnimationMode     = ONCE
			End
		End		
				
		AnimationState        = MOVING FIRING_OR_PREATTACK_A
			ShareAnimation		= Yes
			Animation           = RunAndFire
				AnimationName       = RUPsnt_1_ATRA
				AnimationMode       = LOOP
			End
			Flags               = RANDOMSTART 
		End


	;;------------------ ATTACKING ---------------------------------------

		AnimationState				=	FIRING_OR_PREATTACK_A
			Animation
				AnimationName		=	RUPsnt_1_ATKA 
				AnimationMode		=	LOOP
;				UseWeaponTiming		=	Yes
			End
			Animation
				AnimationName		=	RUPsnt_1_ATKB
				AnimationMode		=	LOOP
;				UseWeaponTiming		=	Yes
			End			
		End
		
;;------------------ MOVING ------------------------------------------
	
;;===== BACKUP
		AnimationState				= MOVING BACKING_UP
			Animation				= BAKA
				AnimationName		= RUPsnt_1_BAKA
				AnimationMode		= LOOP
			End
;			Animation				= BAKB
;				AnimationName		= RUPsnt_1_BAKB
;				AnimationMode		= LOOP
;			End
;			Animation				= BAKC
;				AnimationName		= RUPsnt_1_BAKC
;				AnimationMode		= LOOP
;			End								
		End

; OBSOLETE		
;		AnimationState				= MOVING PANICKING
;			Animation				= RUNM
;				AnimationName		= RUPsnt_1_MFDA
;				AnimationMode		= LOOP
;			End
;			Flags					= RANDOMSTART
;			;;ParticleSysBone			= None InfantryDustTrails
;		End
		
		AnimationState				= MOVING WANDER
			Animation				= WLKA
				AnimationName		= RUPsnt_1_WLKA
				AnimationMode		= LOOP
			End
;			Animation				= WLKE
;				AnimationName		= RUPsnt_1_WLKE
;				AnimationMode		= LOOP
;			End
			
			;;ParticleSysBone     = None InfantryDustTrails
		End
		
		AnimationState				= MOVING
			Animation				= RUNA
				AnimationName		= RUPsnt_1_RUNA
				AnimationMode		= LOOP
;				AnimationSpeedFactorRange = 0.8 0.8
			End
			Animation				= RUNC
				AnimationName		= RUPsnt_1_RUNC
				AnimationMode		= LOOP
;				AnimationSpeedFactorRange = 0.8 0.8
			End			
			Flags					= RANDOMSTART
;			ParticleSysBone			= None InfantryDustTrails
		End
		
; WORKING		
		AnimationState = ACTIVELY_CONSTRUCTING DEPLOYED ; building from too far to smack his hammer
			Animation				=	Stand
				AnimationName		=	RUPsnt_1_IDLA 
				AnimationMode		=	LOOP
			End
		End

		
		AnimationState				= ACTIVELY_CONSTRUCTING
			Animation				= WRKA
				AnimationName		= RUPsnt_1_WRKA
				AnimationMode		= ONCE
			End
			Animation				= WRKD
				AnimationName		= RUPsnt_1_WRKD
				AnimationMode		= ONCE
			End
			Flags					= RANDOMSTART RESTART_ANIM_WHEN_COMPLETE
		End	
	
;;------------ HIT REACTION -----------------------------------------------------

		AnimationState = HIT_REACTION
			Animation = Hit_Level_1_a
				AnimationName = RUPsnt_1_HITA
				AnimationMode = ONCE
			End
		End

;;------------- EMOTIONS ---------------------------------------------

			

;;======== POINTING

		AnimationState				= EMOTION_POINTING
			Animation				= Pointing1
				AnimationName		= RUPsnt_1_PNTA
				AnimationMode		= LOOP
                AnimationSpeedFactorRange = 0.75 1.25
			End
		End

;;======= TERROR
		AnimationState				= EMOTION_AFRAID
			Animation				= &&FEAR&&
				AnimationName		= RUPsnt_1_FERA
				AnimationMode		= LOOP
			End
		End
		
		AnimationState				= EMOTION_TAUNTING
			Animation				= TNTA
				AnimationName		= RUPsnt_1_TNTA
				AnimationMode		= ONCE
			End
			Animation				= TNTB
				AnimationName		= RUPsnt_1_TNTB
				AnimationMode		= ONCE
			End	
			Flags					= RANDOMSTART RESTART_ANIM_WHEN_COMPLETE		
		End

;;====== CELEBRATING		
			AnimationState				= EMOTION_CELEBRATING
				Animation				= CHRA
					AnimationName	    = RUPsnt_1_CHRA
					AnimationMode		= ONCE
				End
				Animation				= CHRB
					AnimationName	    = RUPsnt_1_CHRB
					AnimationMode		= ONCE
				End
				Flags					= RANDOMSTART RESTART_ANIM_WHEN_COMPLETE
			End
			
			AnimationState				= EMOTION_ALERT
				StateName				= STATE_Alert
				Animation				= &&ALERT&&
					AnimationName		= RUPsnt_1_IDLA
					AnimationMode		= LOOP
				End
			End
			
	;;------------- SELECTED ---------------------------------------------

		AnimationState				=	SELECTED
			StateName				=	STATE_Selected
			SimilarRestart			=   Yes			
			Animation				=	ATNB
				AnimationName		=	RUPsnt_1_ATNB
				AnimationMode		=	LOOP
			End
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Idle" then CurDrawableSetTransitionAnimState("TRANS_IdleToSelected") end
				if Prev == "STATE_Selected" then CurDrawableSetTransitionAnimState("TRANS_IdleToSelected") end
			EndScript
		End	

	;;--------------- IDLE STATES -----------------------------------------------------------------	
		IdleAnimationState
			StateName			=	STATE_Idle
			Animation           = IDLA
				AnimationName     = humachiefS_idla
				AnimationMode     = ONCE
				AnimationPriority = 20
			End
		Flags				=	RESTART_ANIM_WHEN_COMPLETE			
		End
		
	;---Transitions-------------------------------------		

		TransitionState       = TRANS_SelectedToIdle	
			Animation           = ATNC
				AnimationName     = RUPsnt_1_ATNC
				AnimationMode     = ONCE
				AnimationSpeedFactorRange = 0.7 1.2
			End
		End
		
		TransitionState				=	TRANS_IdleToSelected
			Animation				=	ATNA
				AnimationName		=	RUPsnt_1_ATNA
				AnimationMode		=	ONCE
				AnimationSpeedFactorRange = 0.7 1.2
			End
		End	
		
	End

    #include "..\..\..\includes\StunDrawModuleSmall.inc"

	; ***DESIGN parameters ***
	Side			= Angmar
	EditorSorting		= UNIT

	ThreatLevel		= ISENGARD_BESERKER_THREAT_LEVEL
	ThreatBreakdown 	= IsengardBeserker_DetailedThreat
		AIKindOf 	= INFANTRY
	End

	ThingClass		= HORDE_UNIT
	CommandPoints		= 0 ;;,;; 30 ;;,;; 25
	BuildCost		= 500 ;ISENGARD_BERSERKER_BUILDCOST
	BuildTime		= ISENGARD_BERSERKER_BUILDTIME
	TransportSlotCount	= TRANSPORTSLOTCOUNT_UNIT
;	MaxSimultaneousOfType	= 3						; Added for BFME2 Expansion

	WeaponSet
		Conditions 	= None
		Weapon 		= PRIMARY    MahudChiefWeapon
	End

	WeaponSet
		Conditions = PLAYER_UPGRADE
		Weapon = PRIMARY    MahudChiefWeaponLevel3
	End

	; WeaponSet
		; Conditions = WEAPONSET_TOGGLE_1
		; Weapon 		= PRIMARY	IsengardBerserkerSword
		; Weapon 		= SECONDARY	IsengardBerserkerTorch
		; OnlyAgainst 	= SECONDARY MINE
	; End

	; WeaponSet
		; Conditions = WEAPONSET_TOGGLE_1 PLAYER_UPGRADE
		; Weapon 		= PRIMARY	IsengardBerserkerSwordBlood
		; Weapon 		= SECONDARY	IsengardBerserkerTorch
		; OnlyAgainst 	= SECONDARY MINE
	; End

	ArmorSet
		Conditions      = None
		Armor           = MahudChiefArmor
		DamageFX        = NormalDamageFX
	End

  	; This is required so that the build phase lasts as long as the anim.
	BuildFadeInOnCreateTime = 2.0

	VisionRange = ISENGARD_BERSERKER_VISION_RANGE
	ShroudClearingRange = ISENGARD_BERSERKER_SHROUD_RANGE

	VisionSide = 35%
	VisionRear = 25%

	MaxVisionBonusPercent = 300%
	VisionBonusTestRadius = 200
	VisionBonusPercentPerFoot = 2.0%


	BountyValue 		= 125
	DisplayName 		= OBJECT:MahudChief
	CrushableLevel 		= 0  				; What am I?:        0 = for infantry, 1 = for trees, 2 = general vehicles
	CrusherLevel	 	= 0 				; What can I crush?: 0 = small animals, 1 = infantry, 2 = trees, 3 = vehicles
	CrushRevengeWeapon 	= BasicInfantryCrushRevenge

	CommandSet = MahudChiefCommandSet


	; *** AUDIO Parameters ***;

	VoiceAttack								= MahudChiefVoiceAttack
	VoiceAttackCharge						= MahudChiefVoiceAttackCharge
	VoiceAttackStructure 					= MahudChiefVoiceAttackBuilding
 	VoiceAttackMachine						= MahudChiefVoiceAttack
	VoiceCreated							= MahudChiefVoiceSalute
	VoiceFullyCreated						= MahudChiefVoiceSalute
	VoiceGuard								= MahudChiefVoiceMove
	VoiceMove								= MahudChiefVoiceMove
	VoiceMoveToCamp 						= MahudChiefVoiceMoveCamp
	VoiceMoveWhileAttacking					= MahudChiefVoiceDisengage
	VoicePriority							= 53
	VoiceRetreatToCastle 					= MahudChiefVoiceRetreat
	VoiceSelect								= MahudChiefVoiceSelectMS
	VoiceSelectBattle						= MahudChiefVoiceSelectBattle

	VoiceEnterStateAttack 					= MahudChiefVoiceEnterStateAttack
	VoiceEnterStateAttackCharge 			= MahudChiefVoiceEnterStateAttackCharge
	VoiceEnterStateAttackStructure	 		= MahudChiefVoiceEnterStateAttackBuilding
	VoiceEnterStateAttackMachine 			= MahudChiefVoiceEnterStateAttack
	VoiceEnterStateMove 					= MahudChiefVoiceEnterStateMove
	VoiceEnterStateMoveToCamp 				= MahudChiefVoiceEnterStateMoveCamp
	VoiceEnterStateMoveWhileAttacking		= MahudChiefVoiceEnterStateDisengage
	VoiceEnterStateRetreatToCastle	 		= MahudChiefVoiceEnterStateRetreat

	UnitSpecificSounds
		VoiceEnter				= MahudChiefVoiceGarrison				;for entering SiegeLadder
		VoiceEnterUnitEvilMenTransportShip	= MahudChiefVoiceGarrison
		VoiceEnterUnitMordorMumakil		= MahudChiefVoiceGarrison
		VoiceEnterUnitSlaughterHouse		= MahudChiefVoiceGarrison
		VoiceGarrison				= MahudChiefVoiceGarrison
		VoiceInitiateCaptureBuilding		= MahudChiefVoiceMove
	End

	CrowdResponseKey = Mahud ;EvilMen1

    #include "..\..\..\includes\StandardUnitEvaEvents.inc"

	ClientBehavior = ModelConditionAudioLoopClientBehavior ModuleTag_foo
		ModelCondition = Required:EMOTION_CELEBRATING	Excluded:DYING ENGAGED	Sound:EmotionMenEvilCompilationVoxCheerSinglesLoop	;MOVING ATTACKING
		ModelCondition = Required:EMOTION_TAUNTING		Excluded:DYING ENGAGED	Sound:EmotionMenEvilCompilationVoxTauntSinglesLoop	;MOVING ATTACKING
		ModelCondition = Required:EMOTION_POINTING		Excluded:DYING ENGAGED	Sound:EmotionMenEvilCompilationVoxTauntSinglesLoop
		ModelCondition = Required:RAISING_FLAG			Excluded:DYING ENGAGED	Sound:EmotionMenEvilCompilationVoxTauntSinglesLoop
	End

	Behavior = LargeGroupAudioUpdate ModuleTag_LGAU					;Tie into LargeGroupAudio system
		Key = Humanoid_Male Man Man_Male Mahuddin ;Haradrim_Lancer
	End

	ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
		MaxUpdateRangeCap = 800
		AnimationSound = Sound:FootstepDirtA			Animation:KUKng_SKL.KUKng_RUNA		Frames:4 15			;;,;; ;;; Previously FootstepDirtA
		AnimationSound = Sound:FootstepDirtA			Animation:KUKng_SKL.KUKng_RUNB		Frames:5 15 26 36	;;,;; ;;; Previously FootstepDirtA
		AnimationSound = Sound:TauntHumanHitShield		Animation:KUKng_SKL.KUKng_CHRB		Frames:22 32
		AnimationSound = Sound:BodyFallGenericNoArmor	Animation:KUKng_SKL.KUKng_DIEA		Frames:48
		AnimationSound = Sound:BodyFallGenericNoArmor	Animation:KUKng_SKL.KUKng_DIEB		Frames:18
		AnimationSound = Sound:BodyFallSoldier			Animation:KUKng_SKL.KUKng_LNDA		Frames:4
	End


	; *** ENGINEERING Parameters ***

	RadarPriority = UNIT
	KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY SCORE CAN_USE_SIEGE_TOWER CAN_RIDE_SIEGE_LADDER MINE_TRIGGER ARMY_SUMMARY GRAB_AND_DROP HEAVY_MELEE_HITTER CAN_ATTACK AIRCRAFT_PATH_AROUND

 ;;.;; Added
	Behavior = AutoHealBehavior ModuleTag_BerserkerHealing
		StartsActive = No
		TriggeredBy = Upgrade_ObjectLevel2
		HealingAmount = 20
		HealingDelay = 1000
		StartHealingDelay = HERO_HEAL_DELAY
		HealOnlyIfNotInCombat = Yes
	End
;;.;;


	Body = ActiveBody ModuleTag_02
		MaxHealth         	= 1500 ;800				;BALANCE Uruk Hai Health
		MaxHealthDamaged  	= 700 ;ISENGARD_BERSERKER_HEALTH_DAMAGED
		BurningDeathBehavior	= Yes
		BurningDeathFX		= FX_InfantryBurningFlame
		CheerRadius		= EMOTION_CHEER_RADIUS
    	DodgePercent      = 80%

;; TAKEN OUT BY DESIGN... DON'T PUT THIS BACK...10/2004
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;    	DamagedAttributeModifier = BerserkerDamagedAttributeModifier
;   	ReallyDamagedAttributeModifier = BerserkerReallyDamagedAttributeModifier
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

	End

	Behavior = StancesBehavior ModuleTag_StancesBehavior
       	StanceTemplate = Hero ;;,;; FighterHorde
   	End

	#include "..\..\..\includes\CaptureBuilding.inc"

	;Wambly's Notes - Removed attack buildings command, unit should properly respect combat priorities now

	Behavior = AIUpdateInterface ModuleTag_03
		AutoAcquireEnemiesWhenIdle 	= 	Yes
		;AutoAcquireEnemiesWhenIdle 	= 	Yes ATTACK_BUILDINGS
		MoodAttackCheckRate        	= 	500
		AILuaEventsList			=	IsengardBeserkerFunctions
		AttackPriority			= 	AttackPriority_Infantry
		BurningDeathTime		=	BURNINGDEATH_DURATION_INFANTRY
	End

	Behavior = EmotionTrackerUpdate	Module_EmotionTracker	;;,;; Uncommented for 3.0.0
		TauntAndPointDistance		=	400		; max distance to taunted/pointed objet
		TauntAndPointUpdateDelay	=	1000		; how often scan (milliseconds)
		TauntAndPointExcluded		=	NONE
		AfraidOf			=	AOTR_EMOTION_AFRAIDOF_OBJECTFILTER
		AlwaysAfraidOf			=	EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
		PointAt				=	EMOTION_POINTAT_OBJECTFILTER
		HeroScanDistance		=	150
		FearScanDistance		=	200
		AddEmotion			=	Terror_Base
		AddEmotion			=	Doom_Base
		AddEmotion			=   	BraceForBeingCrushed_Base
		AddEmotion			=	UncontrollableFear_Base_Evil
		AddEmotion			=	FearIdle_Base
		AddEmotion			=	FearBusy_Base
		AddEmotion			=	Point_Base
		AddEmotion			=	Taunt_Base
		AddEmotion			=	CheerIdle_Base
		AddEmotion			=	CheerBusy_Base
		AddEmotion			=	HeroCheerIdle_Base
		AddEmotion			=	HeroCheerBusy_Base
		AddEmotion			=	Alert_Base
	End

	LocomotorSet
		Locomotor     = BerserkerLocomotor		; HumanLocomotor
		Condition     = SET_NORMAL
		Speed         = NORMAL_FOOT_FAST_MEMBER_SPEED
	End

	LocomotorSet
		Locomotor     = BerserkerLocomotor
		Condition     = SET_WANDER
		Speed         = NORMAL_FOOT_FAST_MEMBER_SPEED
	End

	LocomotorSet	;;,;; Uncommented - perhaps to fix invulnerable Berserker bug?
		Locomotor = BurningDeathLocomotorInfantry
		Condition = SET_BURNINGDEATH
		Speed	  = BURNINGDEATH_WANDERSPEED_INFANTRY
	End

	Behavior = PhysicsBehavior ModuleTag_04
		GravityMult = 1.0
	End


	Behavior = SlowDeathBehavior ModuleTag_05
		DeathTypes 		= ALL
		SinkDelay 		= 4000
		SinkRate 		= 1.0     				; in Dist/Sec
		DestructionDelay 	= 10000
		Sound 			= INITIAL MahudChiefVoiceDie			; BerserkerVoiceDie
	End
;------------------Hearts of fire reflect damage--------------------------------------------------------------------------------
  	Behavior = AttributeModifierUpgrade ModuleTag_HoFVisual
		TriggeredBy = Upgrade_SindarinHeavyArmor
		AttributeModifier = ZigurCultistsHeartsofFireVisual
	End
	
  	Behavior = FireWeaponWhenDamagedBehavior SerratedArmor
		StartsActive				= No
		TriggeredBy					= Upgrade_SindarinHeavyArmor
		Permanent 					= Yes
		ReactionWeaponPristine 		= HeartsOfFireReflectWeapon
		ReactionWeaponDamaged		= HeartsOfFireReflectWeapon
		ReactionWeaponReallyDamaged	= HeartsOfFireReflectWeapon
		DamageTypes					= ALL -PIERCE -FLAME -MAGIC -FROST -STRUCTURAL -UNDEFINED -HERO_RANGED -POISON
		DamageAmount				= 1
	End
;------------------------------------------------------------------------------------------------------------------------------
	Behavior = SquishCollide ModuleTag_06
		;nothing
	End

	Behavior = HordeMemberCollide ModuleTag_HMC				; Added for BFME2 Expansion
		;nothing
	End

	Behavior = ProductionUpdate ProductionUpdateModuleTag
		GiveNoXP = Yes
	End


	/////////////////////
	// AISpecialPowers
	/////////////////////

	Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
		CommandButtonName = Command_SetStanceBattle
		SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
	End

	Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive ;;,;; Changed for 3.0.1
		CommandButtonName = Command_AttackMove ;;,;; Command_SetStanceAggressive ;;,;; Changed for 3.0.1
		SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
	End

	Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
		CommandButtonName = Command_SetStanceHoldGround
		SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
	End


	Behavior = AISpecialPowerUpdate IsengardBerserkerCaptureBuildingAI
		CommandButtonName = Command_CaptureBuilding
		SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
	End

	Geometry = CYLINDER
	GeometryMajorRadius = 8.0
	GeometryMinorRadius = 8.0
	GeometryHeight = 19.2
	GeometryIsSmall = Yes
	Shadow = SHADOW_DECAL
	ShadowSizeX = 19;
	ShadowSizeY = 19;
	ShadowTexture = ShadowI;


	// *** AUTO RESOLVE DATA ***
	AutoResolveUnitType = AutoResolveUnit_Soldier
	AutoResolveCombatChain = AutoResolve_SoldierCombatChain

	AutoResolveBody = AutoResolve_IsengardBeserkerBody

	AutoResolveArmor
		Armor = AutoResolve_IsengardBeserkerArmor
	End

	AutoResolveWeapon
		Weapon = AutoResolve_IsengardBeserkerWeapon
	End
End
